<!DOCTYPE html>
<html class="dark" lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>Lewis Structure Generator - Draw Dot Structures Free</title>
    <meta name="description" content="Draw accurate Lewis structures instantly. Save time, avoid errors, and master chemistry faster with our free online Lewis dot structure generator. Trusted by 50,000+ students.">
    <link rel="canonical" href="https://lewisstructuregenerator.org/">
<meta property="og:image" content="https://lewisstructuregenerator.org/logo.jpg">
<meta property="og:url" content="https://lewisstructuregenerator.org">
<meta property="og:title" content="Lewis Structure Generator - Draw Dot Structures Free">
<meta property="og:description" content="Draw accurate Lewis structures instantly. Save time, avoid errors, and master chemistry faster. Trusted by 50,000+ students worldwide.">
<meta property="og:type" content="website">
<meta name='viewport' content='width=device-width, initial-scale=1'>
    <link href="https://fonts.googleapis.com" rel="preconnect"/>
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;500;700;900&family=Noto+Sans:wght@400;500;700&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet"/>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link rel="shortcut icon" href="/favicon.ico"> 
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-ZVSBE45MDG"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-ZVSBE45MDG');
</script>
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#1973f0",
                        "background-light": "#f6f7f8",
                        "background-dark": "#101822",
                        "surface-dark": "#192434",
                        "border-dark": "#233248",
                        "text-secondary": "#91a9ca",
                    },
                    fontFamily: {
                        "display": ["Lexend", "sans-serif"],
                        "body": ["Noto Sans", "sans-serif"],
                    },
                    borderRadius: {"DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "full": "9999px"},
                },
            },
        }
    </script>
    
    <!-- Schema.org Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "Lewis Structure Generator",
      "url": "https://lewisstructuregenerator.org",
      "description": "Free online tool to draw accurate Lewis dot structures instantly. Visualize molecular bonding, geometry, and formal charges.",
      "applicationCategory": "EducationalApplication",
      "operatingSystem": "Any",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "4.8",
        "ratingCount": "1247",
        "bestRating": "5",
        "worstRating": "1"
      },
      "author": {
        "@type": "Organization",
        "name": "Lewis Structure Generator",
        "url": "https://lewisstructuregenerator.org"
      }
    }
    </script>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "Lewis Structure Generator",
      "url": "https://lewisstructuregenerator.org",
      "logo": "https://lewisstructuregenerator.org/logo.jpg",
      "sameAs": [],
      "contactPoint": {
        "@type": "ContactPoint",
        "email": "support@lewisstructuregenerator.org",
        "contactType": "Customer Support"
      }
    }
    </script>
</head>
<body class="bg-background-light dark:bg-background-dark text-slate-900 dark:text-white font-display antialiased min-h-screen flex flex-col overflow-x-hidden selection:bg-primary selection:text-white">

<!-- Header -->
<header class="sticky top-0 z-50 w-full border-b border-solid border-border-dark bg-background-dark/80 backdrop-blur-md">
    <div class="px-4 md:px-10 py-3 max-w-7xl mx-auto flex items-center justify-between">
        <div class="flex items-center gap-3 text-white">
            <div class="size-8 flex items-center justify-center text-primary">
                <span class="material-symbols-outlined text-3xl">hexagon</span>
            </div>
            <h2 class="text-white text-xl font-bold tracking-tight">Lewis Structure Generator</h2>
        </div>
        <nav class="hidden md:flex items-center gap-8">
            <a class="text-white text-sm font-medium hover:text-primary transition-colors cursor-pointer">Choose language</a>
            <a class="text-text-secondary text-sm font-medium hover:text-white transition-colors cursor-pointer" href="/ph/">Filipino</a>
        </nav>
    </div>
</header>

<!-- Main Content -->
<main class="flex-grow flex flex-col">
    <!-- Hero Section -->
    <section class="w-full bg-gradient-to-b from-background-dark via-[#141d2b] to-background-dark pt-12 pb-8 px-4">
        <div class="max-w-4xl mx-auto flex flex-col items-center gap-8">
            <!-- Title -->
            <div class="text-center space-y-4 max-w-2xl">
                <h1 class="text-3xl md:text-5xl font-black tracking-tight text-white leading-tight">
                    Master Lewis Structures in Seconds, Not Hours
                </h1>
                <p class="text-text-secondary text-lg font-light leading-relaxed">
                    Save time on homework, avoid costly mistakes, and boost your chemistry grades. Get accurate Lewis dot structures instantly—trusted by over 50,000 students worldwide.
                </p>
            </div>

            <!-- Input Section -->
            <div class="w-full max-w-xl relative group z-10 flex flex-col gap-3">
                <div class="relative">
                    <div class="absolute -inset-1 bg-gradient-to-r from-primary to-cyan-500 rounded-xl blur opacity-25 group-hover:opacity-50 transition duration-200"></div>
                    <div class="relative flex w-full items-stretch rounded-lg bg-surface-dark shadow-2xl ring-1 ring-border-dark p-1">
                        <input id="formula-input" class="flex-1 bg-transparent border-none text-white placeholder:text-text-secondary px-4 py-3 text-lg focus:ring-0 focus:outline-none" placeholder="H2O" value="H2O"/>
                        <div class="flex items-center gap-2">
                            <button id="random-btn" class="flex items-center gap-2 px-3 py-2 text-text-secondary hover:text-white hover:bg-white/5 rounded-md transition-all text-sm font-medium border border-transparent hover:border-white/10">
                                <span class="material-symbols-outlined text-lg">shuffle</span>
                                <span class="hidden sm:inline">Random<br/>Example</span>
                            </button>
                            <button id="generate-btn" class="bg-gradient-to-r from-primary to-blue-600 hover:from-blue-600 hover:to-primary text-white font-bold px-6 py-3 sm:px-8 sm:py-4 rounded-lg transition-all flex items-center gap-2 sm:gap-3 shadow-2xl shadow-blue-900/40 hover:shadow-blue-500/50 transform hover:scale-105 text-sm sm:text-base whitespace-nowrap">
                                <span class="material-symbols-outlined text-xl">science</span>
                                <span>Visualize Now</span>
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Info Box with Keywords -->
                <div class="space-y-2">
                    <div class="px-4 py-3 bg-surface-dark/50 rounded-lg border border-white/5 text-xs text-text-secondary flex items-start gap-2">
                        <span class="material-symbols-outlined text-primary text-sm mt-0.5">info</span>
                        <p>
                            <span class="text-white font-medium">Draw Lewis structures for:</span> Molecules, ions, chemical compounds, organic molecules, inorganic compounds, Lewis dot diagrams with electron pairs, bonding electrons, and lone pairs.
                        </p>
                    </div>
                    <div class="px-4 py-2 bg-green-500/10 rounded-lg border border-green-500/20 text-xs flex items-center gap-2">
                        <span class="material-symbols-outlined text-green-400 text-sm">check_circle</span>
                        <p class="text-green-300">
                            <span class="font-medium">100% Free</span> • No signup required • Instant results
                        </p>
                    </div>
                </div>
            </div>

            <!-- Results Section -->
            <div id="result-section" class="w-full mt-8">
                <div class="bg-surface-dark rounded-xl border border-border-dark shadow-xl overflow-hidden">
                    <!-- Results Header -->
                    <div class="px-6 py-4 border-b border-border-dark flex flex-col sm:flex-row justify-between items-center gap-4 bg-[#1e293b]">
                        <div class="flex items-center gap-3">
                            <span class="material-symbols-outlined text-green-400">check_circle</span>
                            <h3 id="result-title" class="text-white font-bold text-lg">Result: Water (H₂O)</h3>
                        </div>
                        <div class="flex items-center gap-2">
                            <button id="download-png-btn" class="flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md transition-all text-sm font-medium shadow-lg">
                                <span class="material-symbols-outlined text-lg">download</span>
                                <span>PNG</span>
                            </button>
                            <button id="download-svg-btn" class="flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md transition-all text-sm font-medium shadow-lg">
                                <span class="material-symbols-outlined text-lg">download</span>
                                <span>SVG</span>
                            </button>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-3 min-h-[400px]">
                        <!-- Diagram Section -->
                        <div class="lg:col-span-2 bg-[#0f151e] relative flex items-center justify-center p-8 border-r border-border-dark border-b lg:border-b-0">
                            <div id="structure-diagram" class="relative w-full h-full min-h-[300px] flex items-center justify-center rounded-lg border border-dashed border-border-dark bg-background-dark/50">
                                <!-- Structure will be inserted here -->
                            </div>
                        </div>

                        <!-- Properties Section -->
                        <div class="bg-surface-dark p-6 space-y-6 overflow-y-auto max-h-[500px]">
                            <div>
                                <h4 class="text-sm font-bold text-text-secondary mb-3 uppercase tracking-wider">Molecular Properties</h4>
                                <div class="space-y-3">
                                    <div class="flex justify-between items-center py-2 border-b border-border-dark">
                                        <span class="text-text-secondary text-sm">Valence Electrons</span>
                                        <span id="prop-valence" class="text-white font-bold">8</span>
                                    </div>
                                    <div class="flex justify-between items-center py-2 border-b border-border-dark">
                                        <span class="text-text-secondary text-sm">Net Charge</span>
                                        <span id="prop-charge" class="text-white font-bold">0</span>
                                    </div>
                                    <div class="flex justify-between items-center py-2 border-b border-border-dark">
                                        <span class="text-text-secondary text-sm">Central Atom</span>
                                        <span id="prop-central" class="text-red-400 font-bold">Oxygen</span>
                                    </div>
                                    <div class="flex justify-between items-center py-2 border-b border-border-dark">
                                        <span class="text-text-secondary text-sm">Molar Mass</span>
                                        <span id="prop-mass" class="text-white font-bold">18.015 g/mol</span>
                                    </div>
                                </div>
                            </div>

                            <div>
                                <h4 class="text-sm font-bold text-text-secondary mb-3 uppercase tracking-wider">Geometry</h4>
                                <div class="space-y-3">
                                    <div class="py-2 border-b border-border-dark">
                                        <span id="prop-geometry" class="text-text-secondary text-sm">Bent (V-shaped)</span>
                                    </div>
                                    <div class="flex justify-between items-center py-2 border-b border-border-dark">
                                        <span class="text-text-secondary text-sm">Bond Angle</span>
                                        <span id="prop-angle" class="text-white font-bold">104.5°</span>
                                    </div>
                                    <div class="flex justify-between items-center py-2 border-b border-border-dark">
                                        <span class="text-text-secondary text-sm">Hybridization</span>
                                        <span id="prop-hybrid" class="text-white font-bold">sp³</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Element Composition -->
                            <div>
                                <h4 class="text-sm font-bold text-text-secondary mb-3 uppercase tracking-wider">Element Composition</h4>
                                <div id="element-list" class="space-y-2">
                                    <!-- Will be populated dynamically -->
                                </div>
                            </div>

                            <!-- Composition Chart -->
                            <div>
                                <h4 class="text-sm font-bold text-text-secondary mb-3 uppercase tracking-wider">Mass Percentage</h4>
                                <div class="bg-background-dark rounded-lg p-4">
                                    <canvas id="composition-chart" height="200"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Common Examples Section -->
    <section class="w-full bg-background-dark py-12 px-4">
        <div class="max-w-6xl mx-auto">
            <div class="flex items-center gap-3 mb-8">
                <span class="material-symbols-outlined text-primary text-3xl">science</span>
                <h2 class="text-2xl md:text-3xl font-bold text-white">Common Examples</h2>
            </div>
            
            <div id="example-grid" class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <!-- Example cards will be generated here -->
            </div>
        </div>
    </section>

    <!-- Social Proof Section -->
    <section class="w-full bg-gradient-to-b from-background-dark to-[#0d1117] py-16 px-4">
        <div class="max-w-6xl mx-auto">
            <!-- User Stats -->
            <div class="text-center mb-12">
                <div class="inline-flex items-center gap-2 px-4 py-2 bg-primary/10 border border-primary/20 rounded-full mb-4">
                    <span class="material-symbols-outlined text-primary text-sm">verified</span>
                    <span class="text-primary text-sm font-medium">Trusted by Students Worldwide</span>
                </div>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-8 mt-8">
                    <div class="text-center">
                        <div class="text-4xl md:text-5xl font-black text-white mb-2">50K+</div>
                        <div class="text-text-secondary text-sm">Active Students</div>
                    </div>
                    <div class="text-center">
                        <div class="text-4xl md:text-5xl font-black text-white mb-2">1.2M+</div>
                        <div class="text-text-secondary text-sm">Structures Generated</div>
                    </div>
                    <div class="text-center">
                        <div class="text-4xl md:text-5xl font-black text-white mb-2">4.8★</div>
                        <div class="text-text-secondary text-sm">Average Rating</div>
                    </div>
                    <div class="text-center">
                        <div class="text-4xl md:text-5xl font-black text-white mb-2">98%</div>
                        <div class="text-text-secondary text-sm">Accuracy Rate</div>
                    </div>
                </div>
            </div>

            <!-- Testimonials -->
            <div class="mb-12">
                <h2 class="text-2xl md:text-3xl font-bold text-white text-center mb-8">What Students Say</h2>
                <div class="grid md:grid-cols-3 gap-6">
                    <div class="bg-surface-dark rounded-xl border border-border-dark p-6 space-y-4">
                        <div class="flex items-center gap-1 text-yellow-400">
                            <span class="material-symbols-outlined text-lg">star</span>
                            <span class="material-symbols-outlined text-lg">star</span>
                            <span class="material-symbols-outlined text-lg">star</span>
                            <span class="material-symbols-outlined text-lg">star</span>
                            <span class="material-symbols-outlined text-lg">star</span>
                        </div>
                        <p class="text-text-secondary text-sm leading-relaxed">"This tool saved me countless hours during exam prep. The visualizations are so clear—I finally understand molecular geometry!"</p>
                        <div class="flex items-center gap-3">
                            <div class="size-10 rounded-full bg-gradient-to-br from-primary to-cyan-500 flex items-center justify-center text-white font-bold">S</div>
                            <div>
                                <div class="text-white font-medium text-sm">Sarah Chen</div>
                                <div class="text-text-secondary text-xs">Chemistry Major, MIT</div>
                            </div>
                        </div>
                    </div>

                    <div class="bg-surface-dark rounded-xl border border-border-dark p-6 space-y-4">
                        <div class="flex items-center gap-1 text-yellow-400">
                            <span class="material-symbols-outlined text-lg">star</span>
                            <span class="material-symbols-outlined text-lg">star</span>
                            <span class="material-symbols-outlined text-lg">star</span>
                            <span class="material-symbols-outlined text-lg">star</span>
                            <span class="material-symbols-outlined text-lg">star</span>
                        </div>
                        <p class="text-text-secondary text-sm leading-relaxed">"As a teacher, I recommend this to all my students. It's accurate, fast, and helps them visualize concepts they struggle with in textbooks."</p>
                        <div class="flex items-center gap-3">
                            <div class="size-10 rounded-full bg-gradient-to-br from-green-500 to-emerald-500 flex items-center justify-center text-white font-bold">M</div>
                            <div>
                                <div class="text-white font-medium text-sm">Dr. Michael Rodriguez</div>
                                <div class="text-text-secondary text-xs">AP Chemistry Teacher</div>
                            </div>
                        </div>
                    </div>

                    <div class="bg-surface-dark rounded-xl border border-border-dark p-6 space-y-4">
                        <div class="flex items-center gap-1 text-yellow-400">
                            <span class="material-symbols-outlined text-lg">star</span>
                            <span class="material-symbols-outlined text-lg">star</span>
                            <span class="material-symbols-outlined text-lg">star</span>
                            <span class="material-symbols-outlined text-lg">star</span>
                            <span class="material-symbols-outlined text-lg">star</span>
                        </div>
                        <p class="text-text-secondary text-sm leading-relaxed">"My grades improved from a B to an A after using this tool. It's like having a chemistry tutor available 24/7!"</p>
                        <div class="flex items-center gap-3">
                            <div class="size-10 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-white font-bold">E</div>
                            <div>
                                <div class="text-white font-medium text-sm">Emma Thompson</div>
                                <div class="text-text-secondary text-xs">Pre-Med Student, UCLA</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Trust Badges / Educational Standards -->
            <div class="text-center">
                <p class="text-text-secondary text-sm mb-6">Aligned with Educational Standards</p>
                <div class="flex flex-wrap justify-center items-center gap-8 opacity-60">
                    <div class="flex items-center gap-2">
                        <span class="material-symbols-outlined text-2xl text-white">school</span>
                        <span class="text-white text-sm font-medium">NGSS Aligned</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <span class="material-symbols-outlined text-2xl text-white">verified</span>
                        <span class="text-white text-sm font-medium">AP Chemistry</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <span class="material-symbols-outlined text-2xl text-white">science</span>
                        <span class="text-white text-sm font-medium">IB Chemistry</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <span class="material-symbols-outlined text-2xl text-white">workspace_premium</span>
                        <span class="text-white text-sm font-medium">College Level</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Content Section with Sidebar -->
    <section class="w-full bg-[#0d1117] py-16 px-4">
        <div class="max-w-7xl mx-auto">
            <div class="grid lg:grid-cols-12 gap-8">
                <!-- Main Content -->
                <div class="lg:col-span-8 space-y-12">
                    <!-- About Section -->
                    <div>
                        <div class="flex items-center gap-3 mb-6">
                            <span class="material-symbols-outlined text-primary text-3xl">rocket_launch</span>
                            <h2 class="text-2xl md:text-3xl font-bold text-white">Why Students Choose Our Tool</h2>
                        </div>
                        <div class="bg-surface-dark rounded-xl border border-border-dark p-6 space-y-4">
                            <p class="text-text-secondary leading-relaxed">
                                Stop wasting hours drawing Lewis structures by hand. Our tool <span class="text-white font-medium">saves you time, eliminates errors, and helps you understand chemistry faster</span>—so you can spend more time mastering concepts and less time struggling with diagrams.
                            </p>
                            <div class="grid md:grid-cols-2 gap-4 mt-6">
                                <div class="bg-background-dark rounded-lg p-4 border border-border-dark">
                                    <div class="flex items-start gap-3">
                                        <span class="material-symbols-outlined text-green-400 text-2xl">timer</span>
                                        <div>
                                            <h4 class="text-white font-bold mb-1">Save 10+ Hours Per Week</h4>
                                            <p class="text-text-secondary text-sm">Generate accurate structures in seconds instead of struggling for minutes on each molecule.</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="bg-background-dark rounded-lg p-4 border border-border-dark">
                                    <div class="flex items-start gap-3">
                                        <span class="material-symbols-outlined text-blue-400 text-2xl">trending_up</span>
                                        <div>
                                            <h4 class="text-white font-bold mb-1">Boost Your Grades</h4>
                                            <p class="text-text-secondary text-sm">Get perfect diagrams every time and understand complex molecules faster with clear visualizations.</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="bg-background-dark rounded-lg p-4 border border-border-dark">
                                    <div class="flex items-start gap-3">
                                        <span class="material-symbols-outlined text-purple-400 text-2xl">psychology</span>
                                        <div>
                                            <h4 class="text-white font-bold mb-1">Learn Faster</h4>
                                            <p class="text-text-secondary text-sm">Visual learning helps you grasp molecular geometry and bonding concepts that seem confusing in textbooks.</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="bg-background-dark rounded-lg p-4 border border-border-dark">
                                    <div class="flex items-start gap-3">
                                        <span class="material-symbols-outlined text-yellow-400 text-2xl">verified</span>
                                        <div>
                                            <h4 class="text-white font-bold mb-1">Zero Mistakes</h4>
                                            <p class="text-text-secondary text-sm">Avoid common errors in electron counting, formal charges, and bond placement with our validated algorithm.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- What is Lewis Structure -->
                    <div>
                        <div class="flex items-center gap-3 mb-6">
                            <span class="material-symbols-outlined text-primary text-3xl">school</span>
                            <h2 class="text-2xl md:text-3xl font-bold text-white">What is a Lewis Dot Structure?</h2>
                        </div>
                        <div class="bg-surface-dark rounded-xl border border-border-dark p-6 space-y-4">
                            <p class="text-text-secondary leading-relaxed">
                                A <span class="text-white font-medium">Lewis Structure</span> is an efficient graphical representation of the valence electrons in molecules and polyatomic ions. It is a single line for a single bond (a shared pair or a double bond), a double line is a split line or a triple bond (a pair of dots next to atom next to an unpaired electron) radical).
                            </p>
                            <div class="space-y-3 mt-4">
                                <div class="flex items-start gap-3">
                                    <div class="text-primary font-bold">•</div>
                                    <p class="text-text-secondary text-sm"><span class="text-white font-medium">Bonding Pairs:</span> A single line for a single bond, double line for double bonds, and a triple line for triple bonds.</p>
                                </div>
                                <div class="flex items-start gap-3">
                                    <div class="text-primary font-bold">•</div>
                                    <p class="text-text-secondary text-sm"><span class="text-white font-medium">Lone Pairs:</span> Pairs of dots located on an atom not involved in bonding (non-bonding valence electrons).</p>
                                </div>
                                <div class="flex items-start gap-3">
                                    <div class="text-primary font-bold">•</div>
                                    <p class="text-text-secondary text-sm"><span class="text-white font-medium">Radical Dots:</span> A single dot next to the atom indicates (single electron or radical).</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step by Step Guide -->
                    <div>
                        <div class="flex items-center gap-3 mb-6">
                            <span class="material-symbols-outlined text-primary text-3xl">format_list_numbered</span>
                            <h2 class="text-2xl md:text-3xl font-bold text-white">How to Draw Lewis Structures: Step-by-Step Guide</h2>
                        </div>
                        <div class="space-y-3">
                            <!-- Keeping the existing step-by-step guide structure from the original file -->
                            <div class="bg-surface-dark rounded-lg border border-border-dark p-5">
                                <div class="flex items-start gap-4">
                                    <div class="size-8 rounded-lg bg-primary flex items-center justify-center text-white font-bold flex-shrink-0">1</div>
                                    <div>
                                        <h4 class="text-white font-bold mb-2">Count Valence Electrons</h4>
                                        <p class="text-text-secondary text-sm">Calculate total valence electrons. Carbon (Group 14) has 4, Oxygen (Group 16) has 6. Total = 4 + (2×6) = <span class="text-white font-mono">16 e⁻</span>.</p>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-surface-dark rounded-lg border border-border-dark p-5">
                                <div class="flex items-start gap-4">
                                    <div class="size-8 rounded-lg bg-primary flex items-center justify-center text-white font-bold flex-shrink-0">2</div>
                                    <div>
                                        <h4 class="text-white font-bold mb-2">Determine Central Atom</h4>
                                        <p class="text-text-secondary text-sm">Carbon is less electronegative than Oxygen, so it's central: <span class="text-white font-mono">O-C-O</span></p>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-surface-dark rounded-lg border border-border-dark p-5">
                                <div class="flex items-start gap-4">
                                    <div class="size-8 rounded-lg bg-primary flex items-center justify-center text-white font-bold flex-shrink-0">3</div>
                                    <div>
                                        <h4 class="text-white font-bold mb-2">Draw Single Bonds</h4>
                                        <p class="text-text-secondary text-sm">Connect each oxygen to carbon with a single bond: 2 bonds × 2 e⁻ = 4 e⁻ used. Remaining = 12 e⁻.</p>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-surface-dark rounded-lg border border-border-dark p-5">
                                <div class="flex items-start gap-4">
                                    <div class="size-8 rounded-lg bg-primary flex items-center justify-center text-white font-bold flex-shrink-0">4</div>
                                    <div>
                                        <h4 class="text-white font-bold mb-2">Add Lone Pairs to Outer Atoms</h4>
                                        <p class="text-text-secondary text-sm">Place remaining electrons on oxygen to satisfy their octet. Each needs 6 more e⁻ (3 lone pairs).</p>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-surface-dark rounded-lg border border-border-dark p-5">
                                <div class="flex items-start gap-4">
                                    <div class="size-8 rounded-lg bg-primary flex items-center justify-center text-white font-bold flex-shrink-0">5</div>
                                    <div>
                                        <h4 class="text-white font-bold mb-2">Check Central Atom Octet</h4>
                                        <p class="text-text-secondary text-sm">Carbon has only 4 e⁻ (needs 8). Form double bonds: <span class="text-white font-mono">O=C=O</span></p>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-surface-dark rounded-lg border border-border-dark p-5">
                                <div class="flex items-start gap-4">
                                    <div class="size-8 rounded-lg bg-primary flex items-center justify-center text-white font-bold flex-shrink-0">6</div>
                                    <div>
                                        <h4 class="text-white font-bold mb-2">Verify Final Structure</h4>
                                        <p class="text-text-secondary text-sm mb-2">Check that all atoms satisfy the octet rule and calculate formal charges.</p>
                                        <div class="flex items-center gap-2 mt-2">
                                            <span class="material-symbols-outlined text-green-400 text-sm">check_circle</span>
                                            <span class="text-xs text-text-secondary">All octets complete</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- FAQ Section -->
                    <div>
                        <div class="flex items-center gap-3 mb-6">
                            <span class="material-symbols-outlined text-primary text-3xl">help</span>
                            <h2 class="text-2xl font-bold text-white">Frequently Asked Questions</h2>
                        </div>
                        <div class="space-y-3">
                            <details class="group bg-surface-dark rounded-lg border border-border-dark">
                                <summary class="flex cursor-pointer items-center justify-between p-4 font-medium text-white">
                                    <span>Why do some atoms expand their octet?</span>
                                    <span class="transition group-open:rotate-180 material-symbols-outlined">expand_more</span>
                                </summary>
                                <div class="px-4 pb-4 text-text-secondary text-sm">Elements in period 3+ can use d-orbitals, allowing more than 8 electrons (e.g., PCl₅ has 10).</div>
                            </details>
                            
                            <details class="group bg-surface-dark rounded-lg border border-border-dark">
                                <summary class="flex cursor-pointer items-center justify-between p-4 font-medium text-white">
                                    <span>What is Formal Charge?</span>
                                    <span class="transition group-open:rotate-180 material-symbols-outlined">expand_more</span>
                                </summary>
                                <div class="px-4 pb-4 text-text-secondary text-sm">A theoretical charge calculated by: FC = V - (L + B/2), where V = valence electrons, L = lone pairs, B = bonding electrons.</div>
                            </details>

                            <details class="group bg-surface-dark rounded-lg border border-border-dark">
                                <summary class="flex cursor-pointer items-center justify-between p-4 font-medium text-white">
                                    <span>How do I use the Lewis Structure Generator?</span>
                                    <span class="transition group-open:rotate-180 material-symbols-outlined">expand_more</span>
                                </summary>
                                <div class="px-4 pb-4 text-text-secondary text-sm">Enter your chemical formula and click "Generate". The tool accepts standard notation, ions, and functional groups.</div>
                            </details>

                            <details class="group bg-surface-dark rounded-lg border border-border-dark">
                                <summary class="flex cursor-pointer items-center justify-between p-4 font-medium text-white">
                                    <span>Does this tool support charged ions?</span>
                                    <span class="transition group-open:rotate-180 material-symbols-outlined">expand_more</span>
                                </summary>
                                <div class="px-4 pb-4 text-text-secondary text-sm">Yes! Input ions using notation like SO4 2- or NH4 +.</div>
                            </details>

                            <details class="group bg-surface-dark rounded-lg border border-border-dark">
                                <summary class="flex cursor-pointer items-center justify-between p-4 font-medium text-white">
                                    <span>What molecules are supported?</span>
                                    <span class="transition group-open:rotate-180 material-symbols-outlined">expand_more</span>
                                </summary>
                                <div class="px-4 pb-4 text-text-secondary text-sm">We support a vast range from simple diatomic gases to complex organic compounds, including acids, salts, hydrocarbons, and expanded octets.</div>
                            </details>

                            <details class="group bg-surface-dark rounded-lg border border-border-dark">
                                <summary class="flex cursor-pointer items-center justify-between p-4 font-medium text-white">
                                    <span>Can I see resonance structures?</span>
                                    <span class="transition group-open:rotate-180 material-symbols-outlined">expand_more</span>
                                </summary>
                                <div class="px-4 pb-4 text-text-secondary text-sm">Currently shows the most stable resonance contributor based on formal charge minimization.</div>
                            </details>

                            <details class="group bg-surface-dark rounded-lg border border-border-dark">
                                <summary class="flex cursor-pointer items-center justify-between p-4 font-medium text-white">
                                    <span>Is the VSEPR theory applied here?</span>
                                    <span class="transition group-open:rotate-180 material-symbols-outlined">expand_more</span>
                                </summary>
                                <div class="px-4 pb-4 text-text-secondary text-sm">Yes, molecular geometry and bond angles are calculated using VSEPR theory.</div>
                            </details>

                            <details class="group bg-surface-dark rounded-lg border border-border-dark">
                                <summary class="flex cursor-pointer items-center justify-between p-4 font-medium text-white">
                                    <span>What does "Hybridization" mean?</span>
                                    <span class="transition group-open:rotate-180 material-symbols-outlined">expand_more</span>
                                </summary>
                                <div class="px-4 pb-4 text-text-secondary text-sm">Mixing of atomic orbitals to form new hybrid orbitals (e.g., sp³ in tetrahedral CH₄, sp² in trigonal planar BF₃).</div>
                            </details>

                            <details class="group bg-surface-dark rounded-lg border border-border-dark">
                                <summary class="flex cursor-pointer items-center justify-between p-4 font-medium text-white">
                                    <span>Is this tool free for students?</span>
                                    <span class="transition group-open:rotate-180 material-symbols-outlined">expand_more</span>
                                </summary>
                                <div class="px-4 pb-4 text-text-secondary text-sm">Absolutely! This is a free educational resource for students and teachers.</div>
                            </details>
                        </div>
                    </div>
                </div>

                <!-- Sidebar -->
                <aside class="lg:col-span-4">
                    <div class="bg-surface-dark rounded-xl border border-border-dark p-6 sticky top-24">
                        <h3 class="text-lg font-bold text-white mb-4 flex items-center gap-2">
                            <span class="material-symbols-outlined text-primary">build</span>
                            Related Chemistry Tools
                        </h3>
                        <nav class="flex flex-col gap-2">
                            <a class="flex items-center gap-3 p-3 rounded-lg hover:bg-[#1c2a3f] border border-transparent hover:border-border-dark hover:translate-x-1 transition-all group duration-200 cursor-pointer">
                                <div class="size-8 rounded bg-teal-500/10 text-teal-400 flex items-center justify-center group-hover:bg-teal-500 group-hover:text-white transition-colors">
                                    <span class="material-symbols-outlined text-lg">view_in_ar</span>
                                </div>
                                <div>
                                    <p class="text-white font-medium text-sm">VSEPR Calculator</p>
                                    <p class="text-text-secondary text-xs">Predict molecular geometry</p>
                                </div>
                            </a>
                            
                            <a class="flex items-center gap-3 p-3 rounded-lg hover:bg-[#1c2a3f] border border-transparent hover:border-border-dark hover:translate-x-1 transition-all group duration-200 cursor-pointer">
                                <div class="size-8 rounded bg-purple-500/10 text-purple-400 flex items-center justify-center group-hover:bg-purple-500 group-hover:text-white transition-colors">
                                    <span class="material-symbols-outlined text-lg">scale</span>
                                </div>
                                <div>
                                    <p class="text-white font-medium text-sm">Molar Mass Calculator</p>
                                    <p class="text-text-secondary text-xs">Calculate weights instantly</p>
                                </div>
                            </a>
                            
                            <a class="flex items-center gap-3 p-3 rounded-lg hover:bg-[#1c2a3f] border border-transparent hover:border-border-dark hover:translate-x-1 transition-all group duration-200 cursor-pointer">
                                <div class="size-8 rounded bg-orange-500/10 text-orange-400 flex items-center justify-center group-hover:bg-orange-500 group-hover:text-white transition-colors">
                                    <span class="material-symbols-outlined text-lg">bolt</span>
                                </div>
                                <div>
                                    <p class="text-white font-medium text-sm">Oxidation Number</p>
                                    <p class="text-text-secondary text-xs">Find states for any element</p>
                                </div>
                            </a>

                            <a class="flex items-center gap-3 p-3 rounded-lg hover:bg-[#1c2a3f] border border-transparent hover:border-border-dark hover:translate-x-1 transition-all group duration-200 cursor-pointer">
                                <div class="size-8 rounded bg-yellow-500/10 text-yellow-400 flex items-center justify-center group-hover:bg-yellow-500 group-hover:text-white transition-colors">
                                    <span class="material-symbols-outlined text-lg">functions</span>
                                </div>
                                <div>
                                    <p class="text-white font-medium text-sm">Stoichiometry Solver</p>
                                    <p class="text-text-secondary text-xs">Balance equations easily</p>
                                </div>
                            </a>
                        </nav>

                        <div class="mt-6 pt-6 border-t border-border-dark">
                            <div class="bg-gradient-to-br from-primary/20 to-transparent rounded-xl border border-primary/30 p-5">
                                <div class="flex items-start gap-4">
                                    <span class="material-symbols-outlined text-primary text-3xl">school</span>
                                    <div>
                                        <h4 class="text-white font-bold mb-1">Study for Finals?</h4>
                                        <p class="text-sm text-text-secondary mb-3">Get our complete PDF cheat sheet for Chemical Bonding & Molecular Geometry.</p>
                                        <button class="text-sm font-bold text-primary hover:text-white transition-colors flex items-center gap-1 cursor-pointer">
                                            Download PDF <span class="material-symbols-outlined text-sm">arrow_forward</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </aside>
            </div>
        </div>
    </section>
    
    <!-- Final CTA Section -->
    <section class="w-full bg-gradient-to-r from-primary to-blue-600 py-16 px-4">
        <div class="max-w-4xl mx-auto text-center">
            <h2 class="text-3xl md:text-4xl font-black text-white mb-4">
                Ready to Master Lewis Structures?
            </h2>
            <p class="text-blue-100 text-lg mb-8 max-w-2xl mx-auto">
                Join 50,000+ students who've already improved their chemistry grades. Start drawing accurate Lewis dot structures in seconds—completely free.
            </p>
            <div class="flex flex-col sm:flex-row items-center justify-center gap-4">
                <a href="#formula-input" class="inline-flex items-center gap-3 bg-white text-primary hover:bg-blue-50 font-bold px-8 py-4 rounded-lg shadow-2xl hover:shadow-3xl transition-all transform hover:scale-105 text-lg">
                    <span class="material-symbols-outlined text-2xl">arrow_upward</span>
                    <span>Try It Now - It's Free</span>
                </a>
                <div class="flex items-center gap-2 text-white">
                    <span class="material-symbols-outlined text-sm">check_circle</span>
                    <span class="text-sm">No signup • No credit card • Instant access</span>
                </div>
            </div>
            <div class="mt-8 flex items-center justify-center gap-6 text-white/80 text-sm">
                <div class="flex items-center gap-1">
                    <span class="material-symbols-outlined text-base">timer</span>
                    <span>Save 10+ hours/week</span>
                </div>
                <div class="flex items-center gap-1">
                    <span class="material-symbols-outlined text-base">trending_up</span>
                    <span>Boost your grades</span>
                </div>
                <div class="flex items-center gap-1">
                    <span class="material-symbols-outlined text-base">verified</span>
                    <span>98% accuracy</span>
                </div>
            </div>
        </div>
    </section>
</main>

<!-- Footer -->
<footer class="border-t border-border-dark bg-background-dark py-8">
    <div class="max-w-7xl mx-auto px-4">
        <div class="flex flex-col items-center text-center gap-6">
            <div class="flex items-center gap-2 text-text-secondary">
                <span class="material-symbols-outlined text-lg">hexagon</span>
                <span class="text-sm font-semibold">Please <a href="/contact.html">let us know</a> how we can improve this web app.</span>
                <br><a href='javascript:doNotSellMyInfoToggle();' class='footer'>Do Not Sell My Personal Information</a>
                <script>
                    var tr_already_opted_out = "You already opted out from selling your personal information";
                    var tr_would_you_like_to_opt_out = "Would you like to opt out from selling your personal informaion for the purpose of ads personalization?";
                </script>
            </div>
            <div class="space-y-2">
                <p class="text-text-secondary text-sm max-w-3xl leading-relaxed mx-auto">
                    <strong class="text-white">Lewis Structure Generator</strong> - Free online tool to draw Lewis dot structures, electron dot diagrams, and molecular structures. Calculate formal charges, visualize bonding electrons, lone pairs, and molecular geometry. Perfect for chemistry students, educators, and researchers studying chemical bonding and molecular structure.
                </p>
                <p class="text-text-secondary text-xs mt-4">
                    Using this website, you signify your acceptance of <a href="/terms.html" class="text-primary hover:underline">Terms and Conditions</a> and <a href="/privacypolicy.html" class="text-primary hover:underline">Privacy Policy</a>.
                </p>
                <p class="text-text-secondary text-sm font-medium mt-4">
                    © 2026 LewisStructureGenerator.org. All rights reserved.
                </p>
            </div>
        </div>
    </div>
</footer>

<script>
// Molecular database with alias support
const moleculeAliases = {
    'WATER': 'H2O',
    'METHANE': 'CH4',
    'AMMONIA': 'NH3',
    'CARBON DIOXIDE': 'CO2',
    'CARBONDIOXIDE': 'CO2',
    'SULFUR DIOXIDE': 'SO2',
    'SULFURDIOXIDE': 'SO2',
    'SULFUR TRIOXIDE': 'SO3',
    'SULFURTRIOXIDE': 'SO3',
    'SULFURIC ACID': 'H2SO4',
    'SULFURICACID': 'H2SO4',
    'HYDROGEN CHLORIDE': 'HCL',
    'HYDROGENCHLORIDE': 'HCL',
    'HYDROGEN SULFIDE': 'H2S',
    'HYDROGENSULFIDE': 'H2S',
    'OXYGEN': 'O2',
    'NITROGEN': 'N2',
    'HYDROGEN PEROXIDE': 'H2O2',
    'HYDROGENPEROXIDE': 'H2O2',
    'HYDROGEN FLUORIDE': 'HF',
    'HYDROGENFLUORIDE': 'HF',
    'CHLORINE': 'CL2',
    'ETHANE': 'C2H6',
    'ETHYLENE': 'C2H4',
    'ACETYLENE': 'C2H2',
    'PROPANE': 'C3H8',
    'METHANOL': 'CH3OH',
    'ETHANOL': 'C2H5OH',
    'FORMALDEHYDE': 'CH2O',
    'ACETIC ACID': 'CH3COOH',
    'METHYLAMINE': 'CH3NH2',
    'CHLOROFORM': 'CHCL3',
    'CARBON TETRACHLORIDE': 'CCL4',
    'NITRIC ACID': 'HNO3',
    'PHOSPHORIC ACID': 'H3PO4',
    'OZONE': 'O3',
    'CARBON DISULFIDE': 'CS2',
    'PHOSPHINE': 'PH3',
    'SILANE': 'SIH4'
};

const molecules = {
   // 基础分子（已有）
    'H2O': { name: 'Water', formula: 'H₂O', valenceElectrons: 8, netCharge: 0, centralAtom: 'Oxygen', centralAtomColor: 'red', geometry: 'Bent (V-shaped)', bondAngle: '104.5°', hybridization: 'sp³', structure: 'water', molarMass: 18.015, elements: { 'H': { count: 2, mass: 1.008, color: '#e5e7eb', name: 'Hydrogen' }, 'O': { count: 1, mass: 15.999, color: '#ef4444', name: 'Oxygen' }}},
    
    // 简单无机分子
    'H2': { name: 'Hydrogen Gas', formula: 'H₂', valenceElectrons: 2, netCharge: 0, centralAtom: 'Hydrogen', centralAtomColor: 'gray', geometry: 'Linear', bondAngle: '180°', hybridization: 'sp', structure: 'h2', molarMass: 2.016, elements: { 'H': { count: 2, mass: 1.008, color: '#e5e7eb', name: 'Hydrogen' }}},
    
    'N2': { name: 'Nitrogen Gas', formula: 'N₂', valenceElectrons: 10, netCharge: 0, centralAtom: 'Nitrogen', centralAtomColor: 'blue', geometry: 'Linear', bondAngle: '180°', hybridization: 'sp', structure: 'n2', molarMass: 28.014, elements: { 'N': { count: 2, mass: 14.007, color: '#3b82f6', name: 'Nitrogen' }}},
    
    'O2': { name: 'Oxygen Gas', formula: 'O₂', valenceElectrons: 12, netCharge: 0, centralAtom: 'Oxygen', centralAtomColor: 'red', geometry: 'Linear', bondAngle: '180°', hybridization: 'sp²', structure: 'o2', molarMass: 31.998, elements: { 'O': { count: 2, mass: 15.999, color: '#ef4444', name: 'Oxygen' }}},
    
    'F2': { name: 'Fluorine Gas', formula: 'F₂', valenceElectrons: 14, netCharge: 0, centralAtom: 'Fluorine', centralAtomColor: 'cyan', geometry: 'Linear', bondAngle: '180°', hybridization: 'sp³', structure: 'f2', molarMass: 37.996, elements: { 'F': { count: 2, mass: 18.998, color: '#06b6d4', name: 'Fluorine' }}},
    
    'CL2': { name: 'Chlorine Gas', formula: 'Cl₂', valenceElectrons: 14, netCharge: 0, centralAtom: 'Chlorine', centralAtomColor: 'green', geometry: 'Linear', bondAngle: '180°', hybridization: 'sp³', structure: 'cl2', molarMass: 70.906, elements: { 'Cl': { count: 2, mass: 35.45, color: '#22c55e', name: 'Chlorine' }}},
    
    'BR2': { name: 'Bromine', formula: 'Br₂', valenceElectrons: 14, netCharge: 0, centralAtom: 'Bromine', centralAtomColor: 'orange', geometry: 'Linear', bondAngle: '180°', hybridization: 'sp³', structure: 'br2', molarMass: 159.808, elements: { 'Br': { count: 2, mass: 79.904, color: '#f97316', name: 'Bromine' }}},
    
    // 氢化物
    'CH4': { name: 'Methane', formula: 'CH₄', valenceElectrons: 8, netCharge: 0, centralAtom: 'Carbon', centralAtomColor: 'gray', geometry: 'Tetrahedral', bondAngle: '109.5°', hybridization: 'sp³', structure: 'ch4', molarMass: 16.043, elements: { 'C': { count: 1, mass: 12.011, color: '#9ca3af', name: 'Carbon' }, 'H': { count: 4, mass: 1.008, color: '#e5e7eb', name: 'Hydrogen' }}},
    
    'NH3': { name: 'Ammonia', formula: 'NH₃', valenceElectrons: 8, netCharge: 0, centralAtom: 'Nitrogen', centralAtomColor: 'blue', geometry: 'Trigonal Pyramidal', bondAngle: '107°', hybridization: 'sp³', structure: 'nh3', molarMass: 17.031, elements: { 'N': { count: 1, mass: 14.007, color: '#3b82f6', name: 'Nitrogen' }, 'H': { count: 3, mass: 1.008, color: '#e5e7eb', name: 'Hydrogen' }}},
    
    'PH3': { name: 'Phosphine', formula: 'PH₃', valenceElectrons: 8, netCharge: 0, centralAtom: 'Phosphorus', centralAtomColor: 'orange', geometry: 'Trigonal Pyramidal', bondAngle: '93.5°', hybridization: 'sp³', structure: 'ph3', molarMass: 33.998, elements: { 'P': { count: 1, mass: 30.974, color: '#f97316', name: 'Phosphorus' }, 'H': { count: 3, mass: 1.008, color: '#e5e7eb', name: 'Hydrogen' }}},
    
    'H2S': { name: 'Hydrogen Sulfide', formula: 'H₂S', valenceElectrons: 8, netCharge: 0, centralAtom: 'Sulfur', centralAtomColor: 'yellow', geometry: 'Bent', bondAngle: '92°', hybridization: 'sp³', structure: 'h2s', molarMass: 34.081, elements: { 'H': { count: 2, mass: 1.008, color: '#e5e7eb', name: 'Hydrogen' }, 'S': { count: 1, mass: 32.06, color: '#eab308', name: 'Sulfur' }}},
    
    'HF': { name: 'Hydrogen Fluoride', formula: 'HF', valenceElectrons: 8, netCharge: 0, centralAtom: 'Fluorine', centralAtomColor: 'cyan', geometry: 'Linear', bondAngle: '180°', hybridization: 'sp', structure: 'hf', molarMass: 20.006, elements: { 'H': { count: 1, mass: 1.008, color: '#e5e7eb', name: 'Hydrogen' }, 'F': { count: 1, mass: 18.998, color: '#06b6d4', name: 'Fluorine' }}},
    
    'HCL': { name: 'Hydrogen Chloride', formula: 'HCl', valenceElectrons: 8, netCharge: 0, centralAtom: 'Chlorine', centralAtomColor: 'green', geometry: 'Linear', bondAngle: '180°', hybridization: 'sp', structure: 'hcl', molarMass: 36.458, elements: { 'H': { count: 1, mass: 1.008, color: '#e5e7eb', name: 'Hydrogen' }, 'Cl': { count: 1, mass: 35.45, color: '#22c55e', name: 'Chlorine' }}},
    
    'HBR': { name: 'Hydrogen Bromide', formula: 'HBr', valenceElectrons: 8, netCharge: 0, centralAtom: 'Bromine', centralAtomColor: 'orange', geometry: 'Linear', bondAngle: '180°', hybridization: 'sp', structure: 'hbr', molarMass: 80.912, elements: { 'H': { count: 1, mass: 1.008, color: '#e5e7eb', name: 'Hydrogen' }, 'Br': { count: 1, mass: 79.904, color: '#f97316', name: 'Bromine' }}},
    
    'HI': { name: 'Hydrogen Iodide', formula: 'HI', valenceElectrons: 8, netCharge: 0, centralAtom: 'Iodine', centralAtomColor: 'purple', geometry: 'Linear', bondAngle: '180°', hybridization: 'sp', structure: 'hi', molarMass: 127.904, elements: { 'H': { count: 1, mass: 1.008, color: '#e5e7eb', name: 'Hydrogen' }, 'I': { count: 1, mass: 126.904, color: '#a855f7', name: 'Iodine' }}},
    
    // 碳氧化物
    'CO': { name: 'Carbon Monoxide', formula: 'CO', valenceElectrons: 10, netCharge: 0, centralAtom: 'Carbon', centralAtomColor: 'gray', geometry: 'Linear', bondAngle: '180°', hybridization: 'sp', structure: 'co', molarMass: 28.010, elements: { 'C': { count: 1, mass: 12.011, color: '#9ca3af', name: 'Carbon' }, 'O': { count: 1, mass: 15.999, color: '#ef4444', name: 'Oxygen' }}},
    
    'CO2': { name: 'Carbon Dioxide', formula: 'CO₂', valenceElectrons: 16, netCharge: 0, centralAtom: 'Carbon', centralAtomColor: 'gray', geometry: 'Linear', bondAngle: '180°', hybridization: 'sp', structure: 'co2', molarMass: 44.009, elements: { 'C': { count: 1, mass: 12.011, color: '#9ca3af', name: 'Carbon' }, 'O': { count: 2, mass: 15.999, color: '#ef4444', name: 'Oxygen' }}},
    
    // 氮氧化物
    'NO': { name: 'Nitric Oxide', formula: 'NO', valenceElectrons: 11, netCharge: 0, centralAtom: 'Nitrogen', centralAtomColor: 'blue', geometry: 'Linear', bondAngle: '180°', hybridization: 'sp', structure: 'no', molarMass: 30.006, elements: { 'N': { count: 1, mass: 14.007, color: '#3b82f6', name: 'Nitrogen' }, 'O': { count: 1, mass: 15.999, color: '#ef4444', name: 'Oxygen' }}},
    
    'NO2': { name: 'Nitrogen Dioxide', formula: 'NO₂', valenceElectrons: 17, netCharge: 0, centralAtom: 'Nitrogen', centralAtomColor: 'blue', geometry: 'Bent', bondAngle: '134°', hybridization: 'sp²', structure: 'no2', molarMass: 46.005, elements: { 'N': { count: 1, mass: 14.007, color: '#3b82f6', name: 'Nitrogen' }, 'O': { count: 2, mass: 15.999, color: '#ef4444', name: 'Oxygen' }}},
    
    'N2O': { name: 'Nitrous Oxide', formula: 'N₂O', valenceElectrons: 16, netCharge: 0, centralAtom: 'Nitrogen', centralAtomColor: 'blue', geometry: 'Linear', bondAngle: '180°', hybridization: 'sp', structure: 'n2o', molarMass: 44.013, elements: { 'N': { count: 2, mass: 14.007, color: '#3b82f6', name: 'Nitrogen' }, 'O': { count: 1, mass: 15.999, color: '#ef4444', name: 'Oxygen' }}},
    
    'N2O4': { name: 'Dinitrogen Tetroxide', formula: 'N₂O₄', valenceElectrons: 34, netCharge: 0, centralAtom: 'Nitrogen', centralAtomColor: 'blue', geometry: 'Planar', bondAngle: '134°', hybridization: 'sp²', structure: 'n2o4', molarMass: 92.011, elements: { 'N': { count: 2, mass: 14.007, color: '#3b82f6', name: 'Nitrogen' }, 'O': { count: 4, mass: 15.999, color: '#ef4444', name: 'Oxygen' }}},
    
    // 硫氧化物
    'SO2': { name: 'Sulfur Dioxide', formula: 'SO₂', valenceElectrons: 18, netCharge: 0, centralAtom: 'Sulfur', centralAtomColor: 'yellow', geometry: 'Bent', bondAngle: '119°', hybridization: 'sp²', structure: 'so2', molarMass: 64.066, elements: { 'S': { count: 1, mass: 32.06, color: '#eab308', name: 'Sulfur' }, 'O': { count: 2, mass: 15.999, color: '#ef4444', name: 'Oxygen' }}},
    
    'SO3': { name: 'Sulfur Trioxide', formula: 'SO₃', valenceElectrons: 24, netCharge: 0, centralAtom: 'Sulfur', centralAtomColor: 'yellow', geometry: 'Trigonal Planar', bondAngle: '120°', hybridization: 'sp²', structure: 'so3', molarMass: 80.066, elements: { 'S': { count: 1, mass: 32.06, color: '#eab308', name: 'Sulfur' }, 'O': { count: 3, mass: 15.999, color: '#ef4444', name: 'Oxygen' }}},
    
    // 过氧化物
    'H2O2': { name: 'Hydrogen Peroxide', formula: 'H₂O₂', valenceElectrons: 14, netCharge: 0, centralAtom: 'Oxygen', centralAtomColor: 'red', geometry: 'Bent', bondAngle: '94.8°', hybridization: 'sp³', structure: 'h2o2', molarMass: 34.015, elements: { 'H': { count: 2, mass: 1.008, color: '#e5e7eb', name: 'Hydrogen' }, 'O': { count: 2, mass: 15.999, color: '#ef4444', name: 'Oxygen' }}},
    
    // 简单有机物
    'C2H6': { name: 'Ethane', formula: 'C₂H₆', valenceElectrons: 14, netCharge: 0, centralAtom: 'Carbon', centralAtomColor: 'gray', geometry: 'Tetrahedral', bondAngle: '109.5°', hybridization: 'sp³', structure: 'c2h6', molarMass: 30.069, elements: { 'C': { count: 2, mass: 12.011, color: '#9ca3af', name: 'Carbon' }, 'H': { count: 6, mass: 1.008, color: '#e5e7eb', name: 'Hydrogen' }}},
    
    'C2H4': { name: 'Ethylene', formula: 'C₂H₄', valenceElectrons: 12, netCharge: 0, centralAtom: 'Carbon', centralAtomColor: 'gray', geometry: 'Planar', bondAngle: '120°', hybridization: 'sp²', structure: 'c2h4', molarMass: 28.054, elements: { 'C': { count: 2, mass: 12.011, color: '#9ca3af', name: 'Carbon' }, 'H': { count: 4, mass: 1.008, color: '#e5e7eb', name: 'Hydrogen' }}},
    
    'C2H2': { name: 'Acetylene', formula: 'C₂H₂', valenceElectrons: 10, netCharge: 0, centralAtom: 'Carbon', centralAtomColor: 'gray', geometry: 'Linear', bondAngle: '180°', hybridization: 'sp', structure: 'c2h2', molarMass: 26.038, elements: { 'C': { count: 2, mass: 12.011, color: '#9ca3af', name: 'Carbon' }, 'H': { count: 2, mass: 1.008, color: '#e5e7eb', name: 'Hydrogen' }}},
    
    'C3H8': { name: 'Propane', formula: 'C₃H₈', valenceElectrons: 20, netCharge: 0, centralAtom: 'Carbon', centralAtomColor: 'gray', geometry: 'Tetrahedral', bondAngle: '109.5°', hybridization: 'sp³', structure: 'c3h8', molarMass: 44.096, elements: { 'C': { count: 3, mass: 12.011, color: '#9ca3af', name: 'Carbon' }, 'H': { count: 8, mass: 1.008, color: '#e5e7eb', name: 'Hydrogen' }}},
    
    // 含氧有机物
    'CH3OH': { name: 'Methanol', formula: 'CH₃OH', valenceElectrons: 14, netCharge: 0, centralAtom: 'Carbon', centralAtomColor: 'gray', geometry: 'Tetrahedral', bondAngle: '109.5°', hybridization: 'sp³', structure: 'ch3oh', molarMass: 32.042, elements: { 'C': { count: 1, mass: 12.011, color: '#9ca3af', name: 'Carbon' }, 'H': { count: 4, mass: 1.008, color: '#e5e7eb', name: 'Hydrogen' }, 'O': { count: 1, mass: 15.999, color: '#ef4444', name: 'Oxygen' }}},
    
    'C2H5OH': { name: 'Ethanol', formula: 'C₂H₅OH', valenceElectrons: 20, netCharge: 0, centralAtom: 'Carbon', centralAtomColor: 'gray', geometry: 'Tetrahedral', bondAngle: '109.5°', hybridization: 'sp³', structure: 'c2h5oh', molarMass: 46.069, elements: { 'C': { count: 2, mass: 12.011, color: '#9ca3af', name: 'Carbon' }, 'H': { count: 6, mass: 1.008, color: '#e5e7eb', name: 'Hydrogen' }, 'O': { count: 1, mass: 15.999, color: '#ef4444', name: 'Oxygen' }}},
    
    'CH2O': { name: 'Formaldehyde', formula: 'CH₂O', valenceElectrons: 12, netCharge: 0, centralAtom: 'Carbon', centralAtomColor: 'gray', geometry: 'Planar', bondAngle: '120°', hybridization: 'sp²', structure: 'ch2o', molarMass: 30.026, elements: { 'C': { count: 1, mass: 12.011, color: '#9ca3af', name: 'Carbon' }, 'H': { count: 2, mass: 1.008, color: '#e5e7eb', name: 'Hydrogen' }, 'O': { count: 1, mass: 15.999, color: '#ef4444', name: 'Oxygen' }}},
    
    'CH3COOH': { name: 'Acetic Acid', formula: 'CH₃COOH', valenceElectrons: 24, netCharge: 0, centralAtom: 'Carbon', centralAtomColor: 'gray', geometry: 'Mixed', bondAngle: '120°/109.5°', hybridization: 'sp²/sp³', structure: 'ch3cooh', molarMass: 60.052, elements: { 'C': { count: 2, mass: 12.011, color: '#9ca3af', name: 'Carbon' }, 'H': { count: 4, mass: 1.008, color: '#e5e7eb', name: 'Hydrogen' }, 'O': { count: 2, mass: 15.999, color: '#ef4444', name: 'Oxygen' }}},
    
    // 含氮有机物
    'CH3NH2': { name: 'Methylamine', formula: 'CH₃NH₂', valenceElectrons: 14, netCharge: 0, centralAtom: 'Nitrogen', centralAtomColor: 'blue', geometry: 'Tetrahedral', bondAngle: '109.5°', hybridization: 'sp³', structure: 'ch3nh2', molarMass: 31.057, elements: { 'C': { count: 1, mass: 12.011, color: '#9ca3af', name: 'Carbon' }, 'H': { count: 5, mass: 1.008, color: '#e5e7eb', name: 'Hydrogen' }, 'N': { count: 1, mass: 14.007, color: '#3b82f6', name: 'Nitrogen' }}},
    
    'HCN': { name: 'Hydrogen Cyanide', formula: 'HCN', valenceElectrons: 10, netCharge: 0, centralAtom: 'Carbon', centralAtomColor: 'gray', geometry: 'Linear', bondAngle: '180°', hybridization: 'sp', structure: 'hcn', molarMass: 27.026, elements: { 'H': { count: 1, mass: 1.008, color: '#e5e7eb', name: 'Hydrogen' }, 'C': { count: 1, mass: 12.011, color: '#9ca3af', name: 'Carbon' }, 'N': { count: 1, mass: 14.007, color: '#3b82f6', name: 'Nitrogen' }}},
    
    // 卤代烃
    'CH3CL': { name: 'Methyl Chloride', formula: 'CH₃Cl', valenceElectrons: 14, netCharge: 0, centralAtom: 'Carbon', centralAtomColor: 'gray', geometry: 'Tetrahedral', bondAngle: '109.5°', hybridization: 'sp³', structure: 'ch3cl', molarMass: 50.488, elements: { 'C': { count: 1, mass: 12.011, color: '#9ca3af', name: 'Carbon' }, 'H': { count: 3, mass: 1.008, color: '#e5e7eb', name: 'Hydrogen' }, 'Cl': { count: 1, mass: 35.45, color: '#22c55e', name: 'Chlorine' }}},
    
    'CH2CL2': { name: 'Dichloromethane', formula: 'CH₂Cl₂', valenceElectrons: 20, netCharge: 0, centralAtom: 'Carbon', centralAtomColor: 'gray', geometry: 'Tetrahedral', bondAngle: '109.5°', hybridization: 'sp³', structure: 'ch2cl2', molarMass: 84.933, elements: { 'C': { count: 1, mass: 12.011, color: '#9ca3af', name: 'Carbon' }, 'H': { count: 2, mass: 1.008, color: '#e5e7eb', name: 'Hydrogen' }, 'Cl': { count: 2, mass: 35.45, color: '#22c55e', name: 'Chlorine' }}},
    
    'CHCL3': { name: 'Chloroform', formula: 'CHCl₃', valenceElectrons: 26, netCharge: 0, centralAtom: 'Carbon', centralAtomColor: 'gray', geometry: 'Tetrahedral', bondAngle: '109.5°', hybridization: 'sp³', structure: 'chcl3', molarMass: 119.378, elements: { 'C': { count: 1, mass: 12.011, color: '#9ca3af', name: 'Carbon' }, 'H': { count: 1, mass: 1.008, color: '#e5e7eb', name: 'Hydrogen' }, 'Cl': { count: 3, mass: 35.45, color: '#22c55e', name: 'Chlorine' }}},
    
    'CCL4': { name: 'Carbon Tetrachloride', formula: 'CCl₄', valenceElectrons: 32, netCharge: 0, centralAtom: 'Carbon', centralAtomColor: 'gray', geometry: 'Tetrahedral', bondAngle: '109.5°', hybridization: 'sp³', structure: 'ccl4', molarMass: 153.823, elements: { 'C': { count: 1, mass: 12.011, color: '#9ca3af', name: 'Carbon' }, 'Cl': { count: 4, mass: 35.45, color: '#22c55e', name: 'Chlorine' }}},
    
    // 酸
    'H2SO4': { name: 'Sulfuric Acid', formula: 'H₂SO₄', valenceElectrons: 32, netCharge: 0, centralAtom: 'Sulfur', centralAtomColor: 'yellow', geometry: 'Tetrahedral', bondAngle: '109.5°', hybridization: 'sp³', structure: 'h2so4', molarMass: 98.079, elements: { 'H': { count: 2, mass: 1.008, color: '#e5e7eb', name: 'Hydrogen' }, 'S': { count: 1, mass: 32.06, color: '#eab308', name: 'Sulfur' }, 'O': { count: 4, mass: 15.999, color: '#ef4444', name: 'Oxygen' }}},
    
    'HNO3': { name: 'Nitric Acid', formula: 'HNO₃', valenceElectrons: 24, netCharge: 0, centralAtom: 'Nitrogen', centralAtomColor: 'blue', geometry: 'Planar', bondAngle: '120°', hybridization: 'sp²', structure: 'hno3', molarMass: 63.012, elements: { 'H': { count: 1, mass: 1.008, color: '#e5e7eb', name: 'Hydrogen' }, 'N': { count: 1, mass: 14.007, color: '#3b82f6', name: 'Nitrogen' }, 'O': { count: 3, mass: 15.999, color: '#ef4444', name: 'Oxygen' }}},
    
    'H3PO4': { name: 'Phosphoric Acid', formula: 'H₃PO₄', valenceElectrons: 32, netCharge: 0, centralAtom: 'Phosphorus', centralAtomColor: 'orange', geometry: 'Tetrahedral', bondAngle: '109.5°', hybridization: 'sp³', structure: 'h3po4', molarMass: 97.994, elements: { 'H': { count: 3, mass: 1.008, color: '#e5e7eb', name: 'Hydrogen' }, 'P': { count: 1, mass: 30.974, color: '#f97316', name: 'Phosphorus' }, 'O': { count: 4, mass: 15.999, color: '#ef4444', name: 'Oxygen' }}},
    
    // 膨胀八电子分子
    'PCL5': { name: 'Phosphorus Pentachloride', formula: 'PCl₅', valenceElectrons: 40, netCharge: 0, centralAtom: 'Phosphorus', centralAtomColor: 'orange', geometry: 'Trigonal Bipyramidal', bondAngle: '90°/120°', hybridization: 'sp³d', structure: 'pcl5', molarMass: 208.239, elements: { 'P': { count: 1, mass: 30.974, color: '#f97316', name: 'Phosphorus' }, 'Cl': { count: 5, mass: 35.45, color: '#22c55e', name: 'Chlorine' }}},
    
    'SF6': { name: 'Sulfur Hexafluoride', formula: 'SF₆', valenceElectrons: 48, netCharge: 0, centralAtom: 'Sulfur', centralAtomColor: 'yellow', geometry: 'Octahedral', bondAngle: '90°', hybridization: 'sp³d²', structure: 'sf6', molarMass: 146.055, elements: { 'S': { count: 1, mass: 32.06, color: '#eab308', name: 'Sulfur' }, 'F': { count: 6, mass: 18.998, color: '#06b6d4', name: 'Fluorine' }}},
    
    'XEF4': { name: 'Xenon Tetrafluoride', formula: 'XeF₄', valenceElectrons: 36, netCharge: 0, centralAtom: 'Xenon', centralAtomColor: 'purple', geometry: 'Square Planar', bondAngle: '90°', hybridization: 'sp³d²', structure: 'xef4', molarMass: 207.283, elements: { 'Xe': { count: 1, mass: 131.293, color: '#a855f7', name: 'Xenon' }, 'F': { count: 4, mass: 18.998, color: '#06b6d4', name: 'Fluorine' }}},
    
    // 硼化合物
    'BF3': { name: 'Boron Trifluoride', formula: 'BF₃', valenceElectrons: 24, netCharge: 0, centralAtom: 'Boron', centralAtomColor: 'pink', geometry: 'Trigonal Planar', bondAngle: '120°', hybridization: 'sp²', structure: 'bf3', molarMass: 67.806, elements: { 'B': { count: 1, mass: 10.81, color: '#ec4899', name: 'Boron' }, 'F': { count: 3, mass: 18.998, color: '#06b6d4', name: 'Fluorine' }}},
    
    'BCL3': { name: 'Boron Trichloride', formula: 'BCl₃', valenceElectrons: 24, netCharge: 0, centralAtom: 'Boron', centralAtomColor: 'pink', geometry: 'Trigonal Planar', bondAngle: '120°', hybridization: 'sp²', structure: 'bcl3', molarMass: 117.169, elements: { 'B': { count: 1, mass: 10.81, color: '#ec4899', name: 'Boron' }, 'Cl': { count: 3, mass: 35.45, color: '#22c55e', name: 'Chlorine' }}},
    
    // 硅化合物
    'SIH4': { name: 'Silane', formula: 'SiH₄', valenceElectrons: 8, netCharge: 0, centralAtom: 'Silicon', centralAtomColor: 'slate', geometry: 'Tetrahedral', bondAngle: '109.5°', hybridization: 'sp³', structure: 'sih4', molarMass: 32.117, elements: { 'Si': { count: 1, mass: 28.085, color: '#64748b', name: 'Silicon' }, 'H': { count: 4, mass: 1.008, color: '#e5e7eb', name: 'Hydrogen' }}},
    
    'SICL4': { name: 'Silicon Tetrachloride', formula: 'SiCl₄', valenceElectrons: 32, netCharge: 0, centralAtom: 'Silicon', centralAtomColor: 'slate', geometry: 'Tetrahedral', bondAngle: '109.5°', hybridization: 'sp³', structure: 'sicl4', molarMass: 169.898, elements: { 'Si': { count: 1, mass: 28.085, color: '#64748b', name: 'Silicon' }, 'Cl': { count: 4, mass: 35.45, color: '#22c55e', name: 'Chlorine' }}},
    
    // 其他重要分子
    'O3': { name: 'Ozone', formula: 'O₃', valenceElectrons: 18, netCharge: 0, centralAtom: 'Oxygen', centralAtomColor: 'red', geometry: 'Bent', bondAngle: '117°', hybridization: 'sp²', structure: 'o3', molarMass: 47.998, elements: { 'O': { count: 3, mass: 15.999, color: '#ef4444', name: 'Oxygen' }}},
    
    'CS2': { name: 'Carbon Disulfide', formula: 'CS₂', valenceElectrons: 16, netCharge: 0, centralAtom: 'Carbon', centralAtomColor: 'gray', geometry: 'Linear', bondAngle: '180°', hybridization: 'sp', structure: 'cs2', molarMass: 76.141, elements: { 'C': { count: 1, mass: 12.011, color: '#9ca3af', name: 'Carbon' }, 'S': { count: 2, mass: 32.06, color: '#eab308', name: 'Sulfur' }}},

};

// DOM elements
const input = document.getElementById('formula-input');
const generateBtn = document.getElementById('generate-btn');
const randomBtn = document.getElementById('random-btn');
const resultSection = document.getElementById('result-section');
const exampleGrid = document.getElementById('example-grid');
const elementColors = {
    'H': '#e5e7eb',   // 白色 - 氢
    'C': '#9ca3af',   // 灰色 - 碳
    'N': '#3b82f6',   // 蓝色 - 氮
    'O': '#ef4444',   // 红色 - 氧
    'F': '#06b6d4',   // 青色 - 氟
    'Cl': '#22c55e',  // 绿色 - 氯
    'Br': '#f97316',  // 橙色 - 溴
    'I': '#a855f7',   // 紫色 - 碘
    'S': '#eab308',   // 黄色 - 硫
    'P': '#f97316',   // 橙色 - 磷
    'B': '#ec4899',   // 粉色 - 硼
    'Si': '#64748b',  // 板岩色 - 硅
    'Xe': '#a855f7'   // 紫色 - 氙
};
// Global variables
let compositionChart = null;
let currentMolecule = null;

// Generate example cards
function generateExampleCards() {
const examples = [
    { formula: 'H2O', name: 'Water', geometry: 'Bent' },
    { formula: 'CO2', name: 'Carbon Dioxide', geometry: 'Linear' },
    { formula: 'NH3', name: 'Ammonia', geometry: 'Trigonal' },
    { formula: 'CH4', name: 'Methane', geometry: 'Tetrahedral' },
    { formula: 'C2H4', name: 'Ethylene', geometry: 'Planar' },
    { formula: 'BF3', name: 'Boron Trifluoride', geometry: 'Trigonal' },
    { formula: 'PCL5', name: 'Phosphorus Pentachloride', geometry: 'Bipyramidal' },
    { formula: 'SF6', name: 'Sulfur Hexafluoride', geometry: 'Octahedral' },
    { formula: 'O3', name: 'Ozone', geometry: 'Bent' },
    { formula: 'HNO3', name: 'Nitric Acid', geometry: 'Planar' },
    { formula: 'CH3OH', name: 'Methanol', geometry: 'Tetrahedral' },
    { formula: 'CCL4', name: 'Carbon Tetrachloride', geometry: 'Tetrahedral' }
];

    examples.forEach(ex => {
        const card = document.createElement('div');
        card.className = 'bg-surface-dark rounded-lg border border-border-dark p-4 hover:border-primary/50 transition-all cursor-pointer group';
        card.innerHTML = `
            <div class="text-center mb-3">
                <div class="text-3xl font-bold text-white mb-1">${ex.formula}</div>
                <div class="flex justify-center gap-1 mb-2">
                    <span class="text-xs text-text-secondary">${ex.geometry}</span>
                </div>
            </div>
            <div class="text-text-secondary text-xs text-center group-hover:text-white transition-colors">${ex.name}</div>
        `;
        card.addEventListener('click', () => {
            input.value = ex.formula;
            generateStructure(ex.formula);
            resultSection.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        });
        exampleGrid.appendChild(card);
    });
}

// Event listeners
generateBtn.addEventListener('click', () => {
    const formula = input.value.trim().toUpperCase().replace(/\s+/g, '');
    generateStructure(formula);
});

input.addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
        const formula = input.value.trim().toUpperCase().replace(/\s+/g, '');
        generateStructure(formula);
    }
});

randomBtn.addEventListener('click', () => {
    const formulas = Object.keys(molecules);
    const randomFormula = formulas[Math.floor(Math.random() * formulas.length)];
    input.value = randomFormula;
    generateStructure(randomFormula);
});

// Main generation function
function generateStructure(formula) {
    // Resolve aliases
    let lookupFormula = formula.toUpperCase().replace(/\s+/g, '');
    if (moleculeAliases[lookupFormula]) {
        lookupFormula = moleculeAliases[lookupFormula];
    }
    
    const molecule = molecules[lookupFormula];
    
    if (!molecule) {
        showError(`Sorry, "${formula}" is not supported. Try: H2O, CO2, NH3, CH4, SO2, SO3, H2SO4, HCl, H2S, O2, N2, water, methane, ammonia`);
        return;
    }

    // Store current molecule
    currentMolecule = molecule;

    // Show result section
    resultSection.style.display = 'block';
    
    // Update title
    document.getElementById('result-title').textContent = `Result: ${molecule.name} (${molecule.formula})`;

    // Update properties
    updateProperties(molecule);

    // Update structure diagram
    updateStructure(molecule);

    // Update element composition
    updateElementComposition(molecule);

    // Update composition chart
    updateCompositionChart(molecule);

    // Scroll to result
    setTimeout(() => {
        resultSection.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }, 100);
}

// Update properties panel
function updateProperties(molecule) {
    document.getElementById('prop-valence').textContent = molecule.valenceElectrons;
    document.getElementById('prop-charge').textContent = molecule.netCharge;
    document.getElementById('prop-mass').textContent = `${molecule.molarMass.toFixed(3)} g/mol`;
    
    const centralAtomEl = document.getElementById('prop-central');
    centralAtomEl.textContent = molecule.centralAtom;
    centralAtomEl.className = `text-${molecule.centralAtomColor}-400 font-bold`;
    
    document.getElementById('prop-geometry').textContent = molecule.geometry;
    document.getElementById('prop-angle').textContent = molecule.bondAngle;
    document.getElementById('prop-hybrid').textContent = molecule.hybridization;
}

// Update element composition list
function updateElementComposition(molecule) {
    const elementList = document.getElementById('element-list');
    elementList.innerHTML = '';
    
    for (const [symbol, data] of Object.entries(molecule.elements)) {
        const totalMass = data.count * data.mass;
        const percentage = (totalMass / molecule.molarMass * 100).toFixed(2);
        
        const elementDiv = document.createElement('div');
        elementDiv.className = 'flex items-center justify-between p-2 bg-background-dark rounded border border-border-dark';
        elementDiv.innerHTML = `
            <div class="flex items-center gap-2">
                <div class="size-6 rounded flex items-center justify-center text-xs font-bold" style="background-color: ${data.color}20; color: ${data.color};">
                    ${symbol}
                </div>
                <span class="text-sm text-white">${data.name}</span>
            </div>
            <div class="text-right">
                <div class="text-xs text-text-secondary">×${data.count}</div>
                <div class="text-xs font-bold text-white">${percentage}%</div>
            </div>
        `;
        elementList.appendChild(elementDiv);
    }
}

// Update composition chart
function updateCompositionChart(molecule) {
    const ctx = document.getElementById('composition-chart');
    
    // Destroy existing chart
    if (compositionChart) {
        compositionChart.destroy();
    }
    
    // Prepare data
    const labels = [];
    const data = [];
    const colors = [];
    
    for (const [symbol, elementData] of Object.entries(molecule.elements)) {
        const totalMass = elementData.count * elementData.mass;
        const percentage = (totalMass / molecule.molarMass * 100);
        
        labels.push(`${symbol} (${percentage.toFixed(1)}%)`);
        data.push(percentage);
        colors.push(elementData.color);
    }
    
    // Create new chart
    compositionChart = new Chart(ctx, {
        type: 'doughnut',
        data: {
            labels: labels,
            datasets: [{
                data: data,
                backgroundColor: colors,
                borderColor: '#192434',
                borderWidth: 2
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'bottom',
                    labels: {
                        color: '#91a9ca',
                        font: {
                            family: 'Lexend',
                            size: 11
                        },
                        padding: 10
                    }
                }
            }
        }
    });
}

// Update structure diagram - keeping water structure, adding other cases
function updateStructure(molecule) {
    const container = document.getElementById('structure-diagram');
    let structureHTML = '';

    switch(molecule.structure) {
        case 'water':
            structureHTML = `
                <div class="text-center relative z-10">
                    <div class="flex flex-col items-center gap-2">
                        <div class="flex items-center gap-8 relative">
                            <div class="absolute -top-6 left-1/2 -translate-x-1/2 flex gap-1">
                                <div class="size-2 rounded-full bg-primary animate-pulse"></div>
                                <div class="size-2 rounded-full bg-primary animate-pulse" style="animation-delay: 0.1s;"></div>
                            </div>
                            <div class="size-16 rounded-full bg-red-500/20 border-2 border-red-500 flex items-center justify-center text-white font-bold text-2xl shadow-[0_0_20px_rgba(239,68,68,0.4)] animate-pulse">O</div>
                            <div class="absolute -right-6 top-1/2 -translate-y-1/2 flex flex-col gap-1">
                                <div class="size-2 rounded-full bg-primary animate-pulse" style="animation-delay: 0.2s;"></div>
                                <div class="size-2 rounded-full bg-primary animate-pulse" style="animation-delay: 0.3s;"></div>
                            </div>
                        </div>
                        <div class="flex justify-between w-40 h-12 relative">
                            <div class="w-1 h-14 bg-gradient-to-b from-text-secondary to-transparent rotate-[30deg] origin-top-right absolute left-10"></div>
                            <div class="w-1 h-14 bg-gradient-to-b from-text-secondary to-transparent -rotate-[30deg] origin-top-left absolute right-10"></div>
                        </div>
                        <div class="flex gap-20 mt-1">
                            <div class="size-12 rounded-full bg-white/10 border-2 border-white flex items-center justify-center text-white font-bold text-xl hover:scale-110 transition-transform">H</div>
                            <div class="size-12 rounded-full bg-white/10 border-2 border-white flex items-center justify-center text-white font-bold text-xl hover:scale-110 transition-transform">H</div>
                        </div>
                    </div>
                </div>`;
            break;
// 简单的通用模板（适用于大部分新分子）
case 'generic_linear':  // 用于 H2, F2, Br2, CO, HBr, HI等
    structureHTML = `
        <div class="text-center relative z-10">
            <div class="flex items-center justify-center gap-8">
                <div class="size-16 rounded-full bg-${color1}/20 border-2 border-${color1} flex items-center justify-center text-white font-bold text-2xl animate-pulse">${atom1}</div>
                <div class="w-20 h-1 bg-gradient-to-r from-${color1} via-primary/50 to-${color2}"></div>
                <div class="size-16 rounded-full bg-${color2}/20 border-2 border-${color2} flex items-center justify-center text-white font-bold text-2xl animate-pulse">${atom2}</div>
            </div>
        </div>`;
    break;
            case 'pcl5':
    structureHTML = `
        <div class="text-center relative z-10">
            <div class="relative w-64 h-64 flex items-center justify-center">
                <!-- 中心P原子 -->
                <div class="size-16 rounded-full bg-orange-500/20 border-2 border-orange-500 flex items-center justify-center text-white font-bold text-2xl z-10">P</div>
                
                <!-- 轴向Cl (上) -->
                <div class="absolute top-0 left-1/2 -translate-x-1/2 size-14 rounded-full bg-green-500/20 border-2 border-green-500 flex items-center justify-center text-white font-bold text-xl">Cl</div>
                
                <!-- 轴向Cl (下) -->
                <div class="absolute bottom-0 left-1/2 -translate-x-1/2 size-14 rounded-full bg-green-500/20 border-2 border-green-500 flex items-center justify-center text-white font-bold text-xl">Cl</div>
                
                <!-- 赤道Cl (左) -->
                <div class="absolute left-0 top-1/2 -translate-y-1/2 size-14 rounded-full bg-green-500/20 border-2 border-green-500 flex items-center justify-center text-white font-bold text-xl">Cl</div>
                
                <!-- 赤道Cl (右) -->
                <div class="absolute right-0 top-1/2 -translate-y-1/2 size-14 rounded-full bg-green-500/20 border-2 border-green-500 flex items-center justify-center text-white font-bold text-xl">Cl</div>
                
                <!-- 赤道Cl (前) -->
                <div class="absolute top-1/2 left-1/2 -translate-x-1/2 translate-y-12 size-14 rounded-full bg-green-500/20 border-2 border-green-500 flex items-center justify-center text-white font-bold text-xl">Cl</div>
            </div>
            <div class="text-text-secondary text-xs mt-4">Trigonal Bipyramidal</div>
        </div>`;
    break;
            case 'sf6':
    structureHTML = `
        <div class="text-center relative z-10">
            <div class="relative w-64 h-64 flex items-center justify-center">
                <!-- 中心S原子 -->
                <div class="size-16 rounded-full bg-yellow-500/20 border-2 border-yellow-500 flex items-center justify-center text-white font-bold text-2xl z-10">S</div>
                
                <!-- 6个F原子按八面体排列 -->
                <div class="absolute top-0 left-1/2 -translate-x-1/2 size-12 rounded-full bg-cyan-500/20 border-2 border-cyan-500 flex items-center justify-center text-white font-bold text-lg">F</div>
                <div class="absolute bottom-0 left-1/2 -translate-x-1/2 size-12 rounded-full bg-cyan-500/20 border-2 border-cyan-500 flex items-center justify-center text-white font-bold text-lg">F</div>
                <div class="absolute left-0 top-1/2 -translate-y-1/2 size-12 rounded-full bg-cyan-500/20 border-2 border-cyan-500 flex items-center justify-center text-white font-bold text-lg">F</div>
                <div class="absolute right-0 top-1/2 -translate-y-1/2 size-12 rounded-full bg-cyan-500/20 border-2 border-cyan-500 flex items-center justify-center text-white font-bold text-lg">F</div>
                <div class="absolute top-1/4 left-1/4 size-12 rounded-full bg-cyan-500/20 border-2 border-cyan-500 flex items-center justify-center text-white font-bold text-lg">F</div>
                <div class="absolute bottom-1/4 right-1/4 size-12 rounded-full bg-cyan-500/20 border-2 border-cyan-500 flex items-center justify-center text-white font-bold text-lg">F</div>
            </div>
            <div class="text-text-secondary text-xs mt-4">Octahedral</div>
        </div>`;
    break;
            case 'xef4':
    structureHTML = `
        <div class="text-center relative z-10">
            <div class="relative w-48 h-48 flex items-center justify-center">
                <!-- 中心Xe原子 -->
                <div class="size-16 rounded-full bg-purple-500/20 border-2 border-purple-500 flex items-center justify-center text-white font-bold text-2xl z-10">Xe</div>
                
                <!-- 4个F原子按正方形排列 -->
                <div class="absolute top-0 left-1/2 -translate-x-1/2 size-12 rounded-full bg-cyan-500/20 border-2 border-cyan-500 flex items-center justify-center text-white font-bold text-lg">F</div>
                <div class="absolute bottom-0 left-1/2 -translate-x-1/2 size-12 rounded-full bg-cyan-500/20 border-2 border-cyan-500 flex items-center justify-center text-white font-bold text-lg">F</div>
                <div class="absolute left-0 top-1/2 -translate-y-1/2 size-12 rounded-full bg-cyan-500/20 border-2 border-cyan-500 flex items-center justify-center text-white font-bold text-lg">F</div>
                <div class="absolute right-0 top-1/2 -translate-y-1/2 size-12 rounded-full bg-cyan-500/20 border-2 border-cyan-500 flex items-center justify-center text-white font-bold text-lg">F</div>
            </div>
            <div class="text-text-secondary text-xs mt-4">Square Planar</div>
        </div>`;
    break;
        case 'co2':
            structureHTML = `
                <div class="text-center relative z-10">
                    <div class="flex items-center justify-center gap-6">
                        <div class="relative">
                            <div class="size-14 rounded-full bg-red-500/20 border-2 border-red-500 flex items-center justify-center text-white font-bold text-xl shadow-[0_0_20px_rgba(239,68,68,0.4)] hover:scale-110 transition-transform">O</div>
                            <div class="absolute -top-2 -right-2 flex gap-1">
                                <div class="size-2 rounded-full bg-primary animate-pulse"></div>
                                <div class="size-2 rounded-full bg-primary animate-pulse" style="animation-delay: 0.1s;"></div>
                            </div>
                        </div>
                        <div class="flex flex-col gap-1">
                            <div class="w-16 h-0.5 bg-gradient-to-r from-text-secondary via-primary/50 to-text-secondary"></div>
                            <div class="w-16 h-0.5 bg-gradient-to-r from-text-secondary via-primary/50 to-text-secondary"></div>
                        </div>
                        <div class="size-16 rounded-full bg-gray-500/20 border-2 border-gray-400 flex items-center justify-center text-white font-bold text-2xl shadow-[0_0_15px_rgba(156,163,175,0.3)] animate-pulse">C</div>
                        <div class="flex flex-col gap-1">
                            <div class="w-16 h-0.5 bg-gradient-to-r from-text-secondary via-primary/50 to-text-secondary"></div>
                            <div class="w-16 h-0.5 bg-gradient-to-r from-text-secondary via-primary/50 to-text-secondary"></div>
                        </div>
                        <div class="relative">
                            <div class="size-14 rounded-full bg-red-500/20 border-2 border-red-500 flex items-center justify-center text-white font-bold text-xl shadow-[0_0_20px_rgba(239,68,68,0.4)] hover:scale-110 transition-transform">O</div>
                            <div class="absolute -top-2 -left-2 flex gap-1">
                                <div class="size-2 rounded-full bg-primary animate-pulse" style="animation-delay: 0.2s;"></div>
                                <div class="size-2 rounded-full bg-primary animate-pulse" style="animation-delay: 0.3s;"></div>
                            </div>
                        </div>
                    </div>
                </div>`;
            break;

        case 'nh3':
            structureHTML = `
                <div class="text-center relative z-10">
                    <div class="flex flex-col items-center gap-2">
                        <div class="relative">
                            <div class="absolute -top-6 left-1/2 -translate-x-1/2 flex gap-1">
                                <div class="size-2 rounded-full bg-primary animate-pulse"></div>
                                <div class="size-2 rounded-full bg-primary animate-pulse" style="animation-delay: 0.1s;"></div>
                            </div>
                            <div class="size-16 rounded-full bg-blue-500/20 border-2 border-blue-500 flex items-center justify-center text-white font-bold text-2xl shadow-[0_0_20px_rgba(59,130,246,0.4)] animate-pulse">N</div>
                        </div>
                        <div class="flex justify-between w-48 h-12 relative">
                            <div class="w-1 h-12 bg-gradient-to-b from-text-secondary to-transparent rotate-[35deg] origin-top-right absolute left-8"></div>
                            <div class="w-1 h-12 bg-gradient-to-b from-text-secondary to-transparent absolute left-1/2 -translate-x-1/2"></div>
                            <div class="w-1 h-12 bg-gradient-to-b from-text-secondary to-transparent -rotate-[35deg] origin-top-left absolute right-8"></div>
                        </div>
                        <div class="flex gap-12 mt-1">
                            <div class="size-11 rounded-full bg-white/10 border-2 border-white flex items-center justify-center text-white font-bold text-lg hover:scale-110 transition-transform">H</div>
                            <div class="size-11 rounded-full bg-white/10 border-2 border-white flex items-center justify-center text-white font-bold text-lg hover:scale-110 transition-transform">H</div>
                            <div class="size-11 rounded-full bg-white/10 border-2 border-white flex items-center justify-center text-white font-bold text-lg hover:scale-110 transition-transform">H</div>
                        </div>
                    </div>
                </div>`;
            break;

        case 'ch4':
            structureHTML = `
                <div class="text-center relative z-10">
                    <div class="relative flex items-center justify-center">
                        <div class="size-16 rounded-full bg-gray-500/20 border-2 border-gray-400 flex items-center justify-center text-white font-bold text-2xl z-10 shadow-[0_0_15px_rgba(156,163,175,0.3)] animate-pulse">C</div>
                        
                        <div class="size-11 rounded-full bg-white/10 border-2 border-white flex items-center justify-center text-white font-bold text-lg absolute -top-16 hover:scale-110 transition-transform">H</div>
                        <div class="size-11 rounded-full bg-white/10 border-2 border-white flex items-center justify-center text-white font-bold text-lg absolute -bottom-16 hover:scale-110 transition-transform">H</div>
                        <div class="size-11 rounded-full bg-white/10 border-2 border-white flex items-center justify-center text-white font-bold text-lg absolute -left-20 hover:scale-110 transition-transform">H</div>
                        <div class="size-11 rounded-full bg-white/10 border-2 border-white flex items-center justify-center text-white font-bold text-lg absolute -right-20 hover:scale-110 transition-transform">H</div>
                        
                        <div class="w-1 h-16 bg-gradient-to-b from-text-secondary to-transparent absolute top-0 left-1/2 -translate-x-1/2 -translate-y-full"></div>
                        <div class="w-1 h-16 bg-gradient-to-t from-text-secondary to-transparent absolute bottom-0 left-1/2 -translate-x-1/2 translate-y-full"></div>
                        <div class="w-16 h-1 bg-gradient-to-r from-text-secondary to-transparent absolute left-0 top-1/2 -translate-y-1/2 -translate-x-full"></div>
                        <div class="w-16 h-1 bg-gradient-to-l from-text-secondary to-transparent absolute right-0 top-1/2 -translate-y-1/2 translate-x-full"></div>
                    </div>
                </div>`;
            break;

        case 'so2':
            structureHTML = `
                <div class="text-center relative z-10">
                    <div class="flex flex-col items-center gap-2">
                        <div class="flex items-center gap-8 relative">
                            <div class="absolute -top-6 left-1/2 -translate-x-1/2 flex gap-1">
                                <div class="size-2 rounded-full bg-primary animate-pulse"></div>
                                <div class="size-2 rounded-full bg-primary animate-pulse" style="animation-delay: 0.1s;"></div>
                            </div>
                            <div class="size-16 rounded-full bg-yellow-500/20 border-2 border-yellow-500 flex items-center justify-center text-white font-bold text-2xl shadow-[0_0_20px_rgba(234,179,8,0.4)] animate-pulse">S</div>
                        </div>
                        <div class="flex justify-between w-40 h-12 relative">
                            <div class="flex flex-col gap-1 absolute left-8 rotate-[25deg] origin-top-right">
                                <div class="w-12 h-0.5 bg-gradient-to-r from-text-secondary to-transparent"></div>
                                <div class="w-12 h-0.5 bg-gradient-to-r from-text-secondary to-transparent"></div>
                            </div>
                            <div class="flex flex-col gap-1 absolute right-8 -rotate-[25deg] origin-top-left">
                                <div class="w-12 h-0.5 bg-gradient-to-l from-text-secondary to-transparent"></div>
                                <div class="w-12 h-0.5 bg-gradient-to-l from-text-secondary to-transparent"></div>
                            </div>
                        </div>
                        <div class="flex gap-20 mt-4">
                            <div class="relative">
                                <div class="size-14 rounded-full bg-red-500/20 border-2 border-red-500 flex items-center justify-center text-white font-bold text-xl shadow-[0_0_20px_rgba(239,68,68,0.4)] hover:scale-110 transition-transform">O</div>
                                <div class="absolute -bottom-3 -left-2 flex gap-1">
                                    <div class="size-2 rounded-full bg-primary animate-pulse" style="animation-delay: 0.2s;"></div>
                                    <div class="size-2 rounded-full bg-primary animate-pulse" style="animation-delay: 0.3s;"></div>
                                </div>
                            </div>
                            <div class="relative">
                                <div class="size-14 rounded-full bg-red-500/20 border-2 border-red-500 flex items-center justify-center text-white font-bold text-xl shadow-[0_0_20px_rgba(239,68,68,0.4)] hover:scale-110 transition-transform">O</div>
                                <div class="absolute -bottom-3 -right-2 flex gap-1">
                                    <div class="size-2 rounded-full bg-primary animate-pulse" style="animation-delay: 0.4s;"></div>
                                    <div class="size-2 rounded-full bg-primary animate-pulse" style="animation-delay: 0.5s;"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>`;
            break;

        case 'hcl':
            structureHTML = `
                <div class="text-center relative z-10">
                    <div class="flex items-center justify-center gap-8">
                        <div class="size-14 rounded-full bg-white/10 border-2 border-white flex items-center justify-center text-white font-bold text-xl hover:scale-110 transition-transform">H</div>
                        <div class="w-20 h-1 bg-gradient-to-r from-white via-primary/50 to-green-500"></div>
                        <div class="relative">
                            <div class="size-16 rounded-full bg-green-500/20 border-2 border-green-500 flex items-center justify-center text-white font-bold text-2xl shadow-[0_0_20px_rgba(34,197,94,0.4)] animate-pulse">Cl</div>
                            <div class="absolute -top-3 -right-3 flex flex-col gap-1">
                                <div class="flex gap-1">
                                    <div class="size-2 rounded-full bg-primary animate-pulse"></div>
                                    <div class="size-2 rounded-full bg-primary animate-pulse" style="animation-delay: 0.1s;"></div>
                                </div>
                                <div class="flex gap-1">
                                    <div class="size-2 rounded-full bg-primary animate-pulse" style="animation-delay: 0.2s;"></div>
                                    <div class="size-2 rounded-full bg-primary animate-pulse" style="animation-delay: 0.3s;"></div>
                                </div>
                                <div class="flex gap-1">
                                    <div class="size-2 rounded-full bg-primary animate-pulse" style="animation-delay: 0.4s;"></div>
                                    <div class="size-2 rounded-full bg-primary animate-pulse" style="animation-delay: 0.5s;"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>`;
            break;

        case 'h2s':
            structureHTML = `
                <div class="text-center relative z-10">
                    <div class="flex flex-col items-center gap-2">
                        <div class="flex items-center gap-8 relative">
                            <div class="absolute -top-6 left-1/2 -translate-x-1/2 flex gap-1">
                                <div class="size-2 rounded-full bg-primary animate-pulse"></div>
                                <div class="size-2 rounded-full bg-primary animate-pulse" style="animation-delay: 0.1s;"></div>
                            </div>
                            <div class="size-16 rounded-full bg-yellow-500/20 border-2 border-yellow-500 flex items-center justify-center text-white font-bold text-2xl shadow-[0_0_20px_rgba(234,179,8,0.4)] animate-pulse">S</div>
                            <div class="absolute -right-6 top-1/2 -translate-y-1/2 flex flex-col gap-1">
                                <div class="size-2 rounded-full bg-primary animate-pulse" style="animation-delay: 0.2s;"></div>
                                <div class="size-2 rounded-full bg-primary animate-pulse" style="animation-delay: 0.3s;"></div>
                            </div>
                        </div>
                        <div class="flex justify-between w-40 h-12 relative">
                            <div class="w-1 h-14 bg-gradient-to-b from-text-secondary to-transparent rotate-[30deg] origin-top-right absolute left-10"></div>
                            <div class="w-1 h-14 bg-gradient-to-b from-text-secondary to-transparent -rotate-[30deg] origin-top-left absolute right-10"></div>
                        </div>
                        <div class="flex gap-20 mt-1">
                            <div class="size-12 rounded-full bg-white/10 border-2 border-white flex items-center justify-center text-white font-bold text-xl hover:scale-110 transition-transform">H</div>
                            <div class="size-12 rounded-full bg-white/10 border-2 border-white flex items-center justify-center text-white font-bold text-xl hover:scale-110 transition-transform">H</div>
                        </div>
                    </div>
                </div>`;
            break;

        case 'o2':
            structureHTML = `
                <div class="text-center relative z-10">
                    <div class="flex items-center justify-center gap-6">
                        <div class="relative">
                            <div class="size-16 rounded-full bg-red-500/20 border-2 border-red-500 flex items-center justify-center text-white font-bold text-2xl shadow-[0_0_20px_rgba(239,68,68,0.4)] hover:scale-110 transition-transform">O</div>
                            <div class="absolute -top-3 -left-3 flex flex-col gap-1">
                                <div class="flex gap-1">
                                    <div class="size-2 rounded-full bg-primary animate-pulse"></div>
                                    <div class="size-2 rounded-full bg-primary animate-pulse" style="animation-delay: 0.1s;"></div>
                                </div>
                                <div class="flex gap-1">
                                    <div class="size-2 rounded-full bg-primary animate-pulse" style="animation-delay: 0.2s;"></div>
                                    <div class="size-2 rounded-full bg-primary animate-pulse" style="animation-delay: 0.3s;"></div>
                                </div>
                            </div>
                        </div>
                        <div class="flex flex-col gap-1">
                            <div class="w-16 h-0.5 bg-gradient-to-r from-red-500 via-primary/50 to-red-500"></div>
                            <div class="w-16 h-0.5 bg-gradient-to-r from-red-500 via-primary/50 to-red-500"></div>
                        </div>
                        <div class="relative">
                            <div class="size-16 rounded-full bg-red-500/20 border-2 border-red-500 flex items-center justify-center text-white font-bold text-2xl shadow-[0_0_20px_rgba(239,68,68,0.4)] hover:scale-110 transition-transform">O</div>
                            <div class="absolute -top-3 -right-3 flex flex-col gap-1">
                                <div class="flex gap-1">
                                    <div class="size-2 rounded-full bg-primary animate-pulse" style="animation-delay: 0.4s;"></div>
                                    <div class="size-2 rounded-full bg-primary animate-pulse" style="animation-delay: 0.5s;"></div>
                                </div>
                                <div class="flex gap-1">
                                    <div class="size-2 rounded-full bg-primary animate-pulse" style="animation-delay: 0.6s;"></div>
                                    <div class="size-2 rounded-full bg-primary animate-pulse" style="animation-delay: 0.7s;"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>`;
            break;

        case 'so3':
            structureHTML = `
                <div class="text-center relative z-10">
                    <div class="flex flex-col items-center">
                        <div class="size-16 rounded-full bg-yellow-500/20 border-2 border-yellow-500 flex items-center justify-center text-white font-bold text-2xl shadow-[0_0_20px_rgba(234,179,8,0.4)] animate-pulse mb-8">S</div>
                        
                        <div class="relative w-48 h-32">
                            <div class="absolute -top-16 left-1/2 -translate-x-1/2">
                                <div class="size-14 rounded-full bg-red-500/20 border-2 border-red-500 flex items-center justify-center text-white font-bold text-xl hover:scale-110 transition-transform">O</div>
                            </div>
                            <div class="absolute top-8 -left-8">
                                <div class="size-14 rounded-full bg-red-500/20 border-2 border-red-500 flex items-center justify-center text-white font-bold text-xl hover:scale-110 transition-transform">O</div>
                            </div>
                            <div class="absolute top-8 -right-8">
                                <div class="size-14 rounded-full bg-red-500/20 border-2 border-red-500 flex items-center justify-center text-white font-bold text-xl hover:scale-110 transition-transform">O</div>
                            </div>
                        </div>
                    </div>
                </div>`;
            break;

        case 'h2so4':
            structureHTML = `
                <div class="text-center relative z-10">
                    <div class="flex flex-col items-center gap-4">
                        <div class="text-white text-sm">H-O-S(=O)(=O)-O-H</div>
                        <div class="size-16 rounded-full bg-yellow-500/20 border-2 border-yellow-500 flex items-center justify-center text-white font-bold text-2xl shadow-[0_0_20px_rgba(234,179,8,0.4)] animate-pulse">S</div>
                        <div class="text-text-secondary text-xs">Tetrahedral geometry</div>
                    </div>
                </div>`;
            break;

        case 'n2':
            structureHTML = `
                <div class="text-center relative z-10">
                    <div class="flex items-center justify-center gap-4">
                        <div class="size-16 rounded-full bg-blue-500/20 border-2 border-blue-500 flex items-center justify-center text-white font-bold text-2xl shadow-[0_0_20px_rgba(59,130,246,0.4)] animate-pulse">N</div>
                        <div class="flex flex-col gap-0.5">
                            <div class="w-16 h-0.5 bg-gradient-to-r from-blue-500 via-primary/50 to-blue-500"></div>
                            <div class="w-16 h-0.5 bg-gradient-to-r from-blue-500 via-primary/50 to-blue-500"></div>
                            <div class="w-16 h-0.5 bg-gradient-to-r from-blue-500 via-primary/50 to-blue-500"></div>
                        </div>
                        <div class="size-16 rounded-full bg-blue-500/20 border-2 border-blue-500 flex items-center justify-center text-white font-bold text-2xl shadow-[0_0_20px_rgba(59,130,246,0.4)] animate-pulse">N</div>
                    </div>
                    <div class="text-text-secondary text-xs mt-4">Triple bond</div>
                </div>`;
            break;

        case 'h2o2':
            structureHTML = `
                <div class="text-center relative z-10">
                    <div class="flex items-center justify-center gap-6">
                        <div class="size-12 rounded-full bg-white/10 border-2 border-white flex items-center justify-center text-white font-bold text-xl hover:scale-110 transition-transform">H</div>
                        <div class="w-10 h-1 bg-gradient-to-r from-white to-red-500"></div>
                        <div class="size-16 rounded-full bg-red-500/20 border-2 border-red-500 flex items-center justify-center text-white font-bold text-2xl shadow-[0_0_20px_rgba(239,68,68,0.4)] animate-pulse">O</div>
                        <div class="w-10 h-1 bg-gradient-to-r from-red-500 to-red-500"></div>
                        <div class="size-16 rounded-full bg-red-500/20 border-2 border-red-500 flex items-center justify-center text-white font-bold text-2xl shadow-[0_0_20px_rgba(239,68,68,0.4)] animate-pulse">O</div>
                        <div class="w-10 h-1 bg-gradient-to-r from-red-500 to-white"></div>
                        <div class="size-12 rounded-full bg-white/10 border-2 border-white flex items-center justify-center text-white font-bold text-xl hover:scale-110 transition-transform">H</div>
                    </div>
                </div>`;
            break;

        case 'hf':
            structureHTML = `
                <div class="text-center relative z-10">
                    <div class="flex items-center justify-center gap-8">
                        <div class="size-14 rounded-full bg-white/10 border-2 border-white flex items-center justify-center text-white font-bold text-xl hover:scale-110 transition-transform">H</div>
                        <div class="w-20 h-1 bg-gradient-to-r from-white via-primary/50 to-cyan-500"></div>
                        <div class="relative">
                            <div class="size-16 rounded-full bg-cyan-500/20 border-2 border-cyan-500 flex items-center justify-center text-white font-bold text-2xl shadow-[0_0_20px_rgba(6,182,212,0.4)] animate-pulse">F</div>
                        </div>
                    </div>
                </div>`;
            break;

        case 'cl2':
            structureHTML = `
                <div class="text-center relative z-10">
                    <div class="flex items-center justify-center gap-6">
                        <div class="size-16 rounded-full bg-green-500/20 border-2 border-green-500 flex items-center justify-center text-white font-bold text-2xl shadow-[0_0_20px_rgba(34,197,94,0.4)] animate-pulse">Cl</div>
                        <div class="w-20 h-1 bg-gradient-to-r from-green-500 via-primary/50 to-green-500"></div>
                        <div class="size-16 rounded-full bg-green-500/20 border-2 border-green-500 flex items-center justify-center text-white font-bold text-2xl shadow-[0_0_20px_rgba(34,197,94,0.4)] animate-pulse">Cl</div>
                    </div>
                </div>`;
            break;

        default:
            structureHTML = '<div class="text-white">Structure diagram loading...</div>';
    }

    container.innerHTML = structureHTML;
}

// Show error message
function showError(message) {
    const container = document.getElementById('structure-diagram');
    container.innerHTML = `
        <div class="flex flex-col items-center justify-center gap-4 text-center p-8">
            <span class="material-symbols-outlined text-red-400 text-5xl">error</span>
            <p class="text-text-secondary">${message}</p>
        </div>
    `;
    
    resultSection.style.display = 'block';
    resultSection.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
}

// PNG Download
document.getElementById('download-png-btn').addEventListener('click', async function() {
    const diagramElement = document.getElementById('structure-diagram');
    
    try {
        const canvas = await html2canvas(diagramElement, {
            backgroundColor: '#0f151e',
            scale: 2,
            logging: false
        });
        
        const link = document.createElement('a');
        const fileName = currentMolecule ? 
            `lewis-${currentMolecule.name.toLowerCase().replace(/\s+/g, '-')}.png` : 
            'lewis-structure.png';
        link.download = fileName;
        link.href = canvas.toDataURL('image/png');
        link.click();
        
        const btn = this;
        const originalHTML = btn.innerHTML;
        btn.innerHTML = '<span class="material-symbols-outlined text-lg">check_circle</span><span>Downloaded!</span>';
        setTimeout(() => {
            btn.innerHTML = originalHTML;
        }, 2000);
    } catch (error) {
        console.error('Download error:', error);
        alert('Download failed. Please try again.');
    }
});

// SVG Download
document.getElementById('download-svg-btn').addEventListener('click', function() {
    const diagramElement = document.getElementById('structure-diagram');
    
    const svgContent = `<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="800" height="600" viewBox="0 0 800 600">
    <rect width="100%" height="100%" fill="#0f151e"/>
    <foreignObject width="100%" height="100%">
        <div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:flex;align-items:center;justify-content:center;">
            ${diagramElement.innerHTML}
        </div>
    </foreignObject>
</svg>`;
    
    const blob = new Blob([svgContent], { type: 'image/svg+xml;charset=utf-8' });
    const url = URL.createObjectURL(blob);
    const link = document.createElement('a');
    const fileName = currentMolecule ? 
        `lewis-${currentMolecule.name.toLowerCase().replace(/\s+/g, '-')}.svg` : 
        'lewis-structure.svg';
    link.download = fileName;
    link.href = url;
    link.click();
    URL.revokeObjectURL(url);
    
    const btn = this;
    const originalHTML = btn.innerHTML;
    btn.innerHTML = '<span class="material-symbols-outlined text-lg">check_circle</span><span>Downloaded!</span>';
    setTimeout(() => {
        btn.innerHTML = originalHTML;
    }, 2000);
});

// Initialize on page load
window.addEventListener('load', () => {
    generateExampleCards();
    generateStructure('H2O');
});
</script>

</body>
</html>
